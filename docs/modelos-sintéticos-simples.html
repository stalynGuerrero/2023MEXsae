<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Modelos sintéticos simples | Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos</title>
  <meta name="description" content="Taller de instalación de capacidades en SAE." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Modelos sintéticos simples | Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Taller de instalación de capacidades en SAE." />
  <meta name="github-repo" content="psirusteam/HHS-Handbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Modelos sintéticos simples | Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos" />
  
  <meta name="twitter:description" content="Taller de instalación de capacidades en SAE." />
  

<meta name="author" content="Andrés Gutiérrez, Stalyn Guerrero" />


<meta name="date" content="2023-10-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="día-1---sesión-3--fundamentos-de-la-inferencia-bayesiana-en-r-y-stan.html"/>
<link rel="next" href="día-1---sesión-4--función-generalizada-de-varianza.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Taller de instalación de capacidades en SAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Agenda</a>
<ul>
<li class="chapter" data-level="" data-path="material-del-curso.html"><a href="material-del-curso.html"><i class="fa fa-check"></i>Material del curso</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="día-1---sesión-1--no-dejar-a-nadie-atrás---ods-y-la-agenda-2030.html"><a href="día-1---sesión-1--no-dejar-a-nadie-atrás---ods-y-la-agenda-2030.html"><i class="fa fa-check"></i><b>1</b> Día 1 - Sesión 1- No dejar a nadie atrás - ODS y la Agenda 2030</a></li>
<li class="chapter" data-level="2" data-path="día-1---sesión-2--censo-e-información-satelital.html"><a href="día-1---sesión-2--censo-e-información-satelital.html"><i class="fa fa-check"></i><b>2</b> Día 1 - Sesión 2- Censo e información satelital</a>
<ul>
<li class="chapter" data-level="2.1" data-path="uso-de-imágenes-satelitales-y-sae.html"><a href="uso-de-imágenes-satelitales-y-sae.html"><i class="fa fa-check"></i><b>2.1</b> Uso de imágenes satelitales y SAE</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="uso-de-imágenes-satelitales-y-sae.html"><a href="uso-de-imágenes-satelitales-y-sae.html#fuentes-de-datos-de-imágenes-satelitales"><i class="fa fa-check"></i><b>2.1.1</b> Fuentes de datos de imágenes satelitales</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="google-earth-eninge.html"><a href="google-earth-eninge.html"><i class="fa fa-check"></i><b>2.2</b> Google Earth Eninge</a></li>
<li class="chapter" data-level="2.3" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html"><i class="fa fa-check"></i><b>2.3</b> Instalación de rgee</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#descargar-información-satelital"><i class="fa fa-check"></i><b>2.3.1</b> Descargar información satelital</a></li>
<li class="chapter" data-level="2.3.2" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#luces-nocturnas"><i class="fa fa-check"></i><b>2.3.2</b> Luces nocturnas</a></li>
<li class="chapter" data-level="2.3.3" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#cubrimiento-cultivos"><i class="fa fa-check"></i><b>2.3.3</b> Cubrimiento cultivos</a></li>
<li class="chapter" data-level="2.3.4" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#cubrimiento-urbanos"><i class="fa fa-check"></i><b>2.3.4</b> Cubrimiento urbanos</a></li>
<li class="chapter" data-level="2.3.5" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#modificación-humana"><i class="fa fa-check"></i><b>2.3.5</b> Modificación humana</a></li>
<li class="chapter" data-level="2.3.6" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#tiempo-promedio-al-hospital"><i class="fa fa-check"></i><b>2.3.6</b> Tiempo promedio al hospital</a></li>
<li class="chapter" data-level="2.3.7" data-path="instalación-de-rgee.html"><a href="instalación-de-rgee.html#tiempo-promedio-al-hospital-en-vehiculo-no-motorizado"><i class="fa fa-check"></i><b>2.3.7</b> Tiempo promedio al hospital en vehiculo no motorizado</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="censos-de-población-y-vivienda.html"><a href="censos-de-población-y-vivienda.html"><i class="fa fa-check"></i><b>2.4</b> Censos de población y vivienda</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="censos-de-población-y-vivienda.html"><a href="censos-de-población-y-vivienda.html#mapas-de-las-variables-con-información-censal."><i class="fa fa-check"></i><b>2.4.1</b> Mapas de las variables con información censal.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="día-1---sesión-3--fundamentos-de-la-inferencia-bayesiana-en-r-y-stan.html"><a href="día-1---sesión-3--fundamentos-de-la-inferencia-bayesiana-en-r-y-stan.html"><i class="fa fa-check"></i><b>3</b> Día 1 - Sesión 3- Fundamentos de la inferencia Bayesiana en R y STAN</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelos-sintéticos-simples.html"><a href="modelos-sintéticos-simples.html"><i class="fa fa-check"></i><b>3.1</b> Modelos sintéticos simples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="modelos-sintéticos-simples.html"><a href="modelos-sintéticos-simples.html#regla-de-bayes"><i class="fa fa-check"></i><b>3.1.1</b> Regla de Bayes</a></li>
<li class="chapter" data-level="3.1.2" data-path="modelos-sintéticos-simples.html"><a href="modelos-sintéticos-simples.html#inferencia-bayesiana."><i class="fa fa-check"></i><b>3.1.2</b> Inferencia Bayesiana.</a></li>
<li class="chapter" data-level="3.1.3" data-path="modelos-sintéticos-simples.html"><a href="modelos-sintéticos-simples.html#modelos-uniparamétricos"><i class="fa fa-check"></i><b>3.1.3</b> Modelos uniparamétricos</a></li>
<li class="chapter" data-level="3.1.4" data-path="modelos-sintéticos-simples.html"><a href="modelos-sintéticos-simples.html#modelos-multiparamétricos"><i class="fa fa-check"></i><b>3.1.4</b> Modelos multiparamétricos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="día-1---sesión-4--función-generalizada-de-varianza.html"><a href="día-1---sesión-4--función-generalizada-de-varianza.html"><i class="fa fa-check"></i><b>4</b> Día 1 - Sesión 4- Función Generalizada de Varianza</a>
<ul>
<li class="chapter" data-level="4.1" data-path="datos-de-la-encuesta.html"><a href="datos-de-la-encuesta.html"><i class="fa fa-check"></i><b>4.1</b> Datos de la encuesta</a></li>
<li class="chapter" data-level="4.2" data-path="análisis-gráfico.html"><a href="análisis-gráfico.html"><i class="fa fa-check"></i><b>4.2</b> Análisis gráfico</a></li>
<li class="chapter" data-level="4.3" data-path="modelo-para-la-varianza.html"><a href="modelo-para-la-varianza.html"><i class="fa fa-check"></i><b>4.3</b> Modelo para la varianza</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="día-2---sesión-1--modelo-de-fay-herriot---estimación-de-la-pobreza.html"><a href="día-2---sesión-1--modelo-de-fay-herriot---estimación-de-la-pobreza.html"><i class="fa fa-check"></i><b>5</b> Día 2 - Sesión 1- Modelo de Fay Herriot - Estimación de la pobreza</a>
<ul>
<li class="chapter" data-level="" data-path="día-2---sesión-1--modelo-de-fay-herriot---estimación-de-la-pobreza.html"><a href="día-2---sesión-1--modelo-de-fay-herriot---estimación-de-la-pobreza.html#modelo-de-área-para-la-estimación-de-la-pobreza"><i class="fa fa-check"></i>Modelo de área para la estimación de la pobreza</a></li>
<li class="chapter" data-level="5.1" data-path="procedimiento-de-estimación.html"><a href="procedimiento-de-estimación.html"><i class="fa fa-check"></i><b>5.1</b> Procedimiento de estimación</a></li>
<li class="chapter" data-level="5.2" data-path="preparando-los-insumos-para-stan.html"><a href="preparando-los-insumos-para-stan.html"><i class="fa fa-check"></i><b>5.2</b> Preparando los insumos para <code>STAN</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="preparando-los-insumos-para-stan.html"><a href="preparando-los-insumos-para-stan.html#resultados-del-modelo-para-los-dominios-observados."><i class="fa fa-check"></i><b>5.2.1</b> Resultados del modelo para los dominios observados.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="proceso-de-benchmark.html"><a href="proceso-de-benchmark.html"><i class="fa fa-check"></i><b>5.3</b> Proceso de Benchmark</a></li>
<li class="chapter" data-level="5.4" data-path="validación-de-los-resultados..html"><a href="validación-de-los-resultados..html"><i class="fa fa-check"></i><b>5.4</b> Validación de los resultados.</a></li>
<li class="chapter" data-level="5.5" data-path="mapa-de-pobreza.html"><a href="mapa-de-pobreza.html"><i class="fa fa-check"></i><b>5.5</b> Mapa de pobreza</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="día-2---sesión-2--modelos-de-área---estimación-de-la-pobreza-y-la-transformación-arcoseno..html"><a href="día-2---sesión-2--modelos-de-área---estimación-de-la-pobreza-y-la-transformación-arcoseno..html"><i class="fa fa-check"></i><b>6</b> Día 2 - Sesión 2- Modelos de área - Estimación de la pobreza y la transformación ArcoSeno.</a>
<ul>
<li class="chapter" data-level="6.1" data-path="procedimiento-de-estimación-1.html"><a href="procedimiento-de-estimación-1.html"><i class="fa fa-check"></i><b>6.1</b> Procedimiento de estimación</a></li>
<li class="chapter" data-level="6.2" data-path="preparando-los-insumos-para-stan-1.html"><a href="preparando-los-insumos-para-stan-1.html"><i class="fa fa-check"></i><b>6.2</b> Preparando los insumos para <code>STAN</code></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="preparando-los-insumos-para-stan-1.html"><a href="preparando-los-insumos-para-stan-1.html#resultados-del-modelo-para-los-dominios-observados.-1"><i class="fa fa-check"></i><b>6.2.1</b> Resultados del modelo para los dominios observados.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mapa-de-pobreza-1.html"><a href="mapa-de-pobreza-1.html"><i class="fa fa-check"></i><b>6.3</b> Mapa de pobreza</a></li>
<li class="chapter" data-level="6.4" data-path="mapa-del-coeficiente-de-variación..html"><a href="mapa-del-coeficiente-de-variación..html"><i class="fa fa-check"></i><b>6.4</b> Mapa del coeficiente de variación.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="día-2---sesión-3--modelos-de-área---estimación-de-la-pobreza-en-familia-beta-y-binomial.html"><a href="día-2---sesión-3--modelos-de-área---estimación-de-la-pobreza-en-familia-beta-y-binomial.html"><i class="fa fa-check"></i><b>7</b> Día 2 - Sesión 3- Modelos de área - Estimación de la pobreza en familia beta y binomial</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelos-de-área-con-variable-respuesta-beta..html"><a href="modelos-de-área-con-variable-respuesta-beta..html"><i class="fa fa-check"></i><b>7.1</b> Modelos de área con variable respuesta Beta.</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modelos-de-área-con-variable-respuesta-beta..html"><a href="modelos-de-área-con-variable-respuesta-beta..html#procedimiento-de-estimación-2"><i class="fa fa-check"></i><b>7.1.1</b> Procedimiento de estimación</a></li>
<li class="chapter" data-level="7.1.2" data-path="modelos-de-área-con-variable-respuesta-beta..html"><a href="modelos-de-área-con-variable-respuesta-beta..html#preparando-los-insumos-para-stan-2"><i class="fa fa-check"></i><b>7.1.2</b> Preparando los insumos para <code>STAN</code></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelos-de-área-con-variable-respuesta-binomial..html"><a href="modelos-de-área-con-variable-respuesta-binomial..html"><i class="fa fa-check"></i><b>7.2</b> Modelos de área con variable respuesta Binomial.</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelos-de-área-con-variable-respuesta-binomial..html"><a href="modelos-de-área-con-variable-respuesta-binomial..html#procedimiento-de-estimación-3"><i class="fa fa-check"></i><b>7.2.1</b> Procedimiento de estimación</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelos-de-área-con-variable-respuesta-binomial..html"><a href="modelos-de-área-con-variable-respuesta-binomial..html#preparando-los-insumos-para-stan-3"><i class="fa fa-check"></i><b>7.2.2</b> Preparando los insumos para <code>STAN</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="día-2---sesión-4--modelo-de-unidad-para-la-estimación-del-ingreso-medio.html"><a href="día-2---sesión-4--modelo-de-unidad-para-la-estimación-del-ingreso-medio.html"><i class="fa fa-check"></i><b>8</b> Día 2 - Sesión 4- Modelo de unidad para la estimación del ingreso medio</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelo-bayesiano..html"><a href="modelo-bayesiano..html"><i class="fa fa-check"></i><b>8.1</b> Modelo bayesiano.</a></li>
<li class="chapter" data-level="8.2" data-path="proceso-de-estimación-en-r.html"><a href="proceso-de-estimación-en-r.html"><i class="fa fa-check"></i><b>8.2</b> Proceso de estimación en <code>R</code></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="proceso-de-estimación-en-r.html"><a href="proceso-de-estimación-en-r.html#encuesta-de-hogares"><i class="fa fa-check"></i><b>8.2.1</b> Encuesta de hogares</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="validación-de-encuesta-frente-al-censo..html"><a href="validación-de-encuesta-frente-al-censo..html"><i class="fa fa-check"></i><b>8.3</b> Validación de encuesta frente al censo.</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="validación-de-encuesta-frente-al-censo..html"><a href="validación-de-encuesta-frente-al-censo..html#niveles-de-agregación-para-colapsar-la-encuesta"><i class="fa fa-check"></i><b>8.3.1</b> Niveles de agregación para colapsar la encuesta</a></li>
<li class="chapter" data-level="8.3.2" data-path="validación-de-encuesta-frente-al-censo..html"><a href="validación-de-encuesta-frente-al-censo..html#creando-base-con-la-encuesta-agregada"><i class="fa fa-check"></i><b>8.3.2</b> Creando base con la encuesta agregada</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="definiendo-el-modelo-multinivel..html"><a href="definiendo-el-modelo-multinivel..html"><i class="fa fa-check"></i><b>8.4</b> Definiendo el modelo multinivel.</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="definiendo-el-modelo-multinivel..html"><a href="definiendo-el-modelo-multinivel..html#distribución-posterior."><i class="fa fa-check"></i><b>8.4.1</b> Distribución posterior.</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="estimación-del-ingreso-medio-nacional.html"><a href="estimación-del-ingreso-medio-nacional.html"><i class="fa fa-check"></i><b>8.5</b> Estimación del ingreso medio nacional</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="estimación-del-ingreso-medio-nacional.html"><a href="estimación-del-ingreso-medio-nacional.html#estimación-para-el-dam-05."><i class="fa fa-check"></i><b>8.5.1</b> Estimación para el dam == “05”.</a></li>
<li class="chapter" data-level="8.5.2" data-path="estimación-del-ingreso-medio-nacional.html"><a href="estimación-del-ingreso-medio-nacional.html#estimación-para-la-dam2-05001"><i class="fa fa-check"></i><b>8.5.2</b> Estimación para la dam2 == “05001”</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="día-3---sesión-1--estimación-de-la-pobreza-a-partir-del-ingreso.html"><a href="día-3---sesión-1--estimación-de-la-pobreza-a-partir-del-ingreso.html"><i class="fa fa-check"></i><b>9</b> Día 3 - Sesión 1- Estimación de la pobreza a partir del ingreso</a>
<ul>
<li class="chapter" data-level="9.1" data-path="proceso-de-estimación-y-predicción.html"><a href="proceso-de-estimación-y-predicción.html"><i class="fa fa-check"></i><b>9.1</b> Proceso de estimación y predicción</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="proceso-de-estimación-y-predicción.html"><a href="proceso-de-estimación-y-predicción.html#distribución-posterior.-1"><i class="fa fa-check"></i><b>9.1.1</b> Distribución posterior.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="estimación-de-la-pobreza.html"><a href="estimación-de-la-pobreza.html"><i class="fa fa-check"></i><b>9.2</b> Estimación de la pobreza</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="estimación-de-la-pobreza.html"><a href="estimación-de-la-pobreza.html#estimación-para-el-dam-05.-1"><i class="fa fa-check"></i><b>9.2.1</b> Estimación para el dam == “05”.</a></li>
<li class="chapter" data-level="9.2.2" data-path="estimación-de-la-pobreza.html"><a href="estimación-de-la-pobreza.html#estimación-para-la-dam2-05001-1"><i class="fa fa-check"></i><b>9.2.2</b> Estimación para la dam2 == “05001”</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="día-3---sesión-2--modelo-de-unidad-para-la-estimación-de-la-pobreza.html"><a href="día-3---sesión-2--modelo-de-unidad-para-la-estimación-de-la-pobreza.html"><i class="fa fa-check"></i><b>10</b> Día 3 - Sesión 2- Modelo de unidad para la estimación de la pobreza</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modelo-de-regresión-logistica..html"><a href="modelo-de-regresión-logistica..html"><i class="fa fa-check"></i><b>10.1</b> Modelo de regresión logistica.</a></li>
<li class="chapter" data-level="10.2" data-path="proceso-de-estimación-en-r-1.html"><a href="proceso-de-estimación-en-r-1.html"><i class="fa fa-check"></i><b>10.2</b> Proceso de estimación en <code>R</code></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="proceso-de-estimación-en-r-1.html"><a href="proceso-de-estimación-en-r-1.html#encuesta-de-hogares-1"><i class="fa fa-check"></i><b>10.2.1</b> Encuesta de hogares</a></li>
<li class="chapter" data-level="10.2.2" data-path="proceso-de-estimación-en-r-1.html"><a href="proceso-de-estimación-en-r-1.html#niveles-de-agregación-para-colapsar-la-encuesta-1"><i class="fa fa-check"></i><b>10.2.2</b> Niveles de agregación para colapsar la encuesta</a></li>
<li class="chapter" data-level="10.2.3" data-path="proceso-de-estimación-en-r-1.html"><a href="proceso-de-estimación-en-r-1.html#creando-base-con-la-encuesta-agregada-1"><i class="fa fa-check"></i><b>10.2.3</b> Creando base con la encuesta agregada</a></li>
<li class="chapter" data-level="10.2.4" data-path="proceso-de-estimación-en-r-1.html"><a href="proceso-de-estimación-en-r-1.html#definiendo-el-modelo-multinivel.-1"><i class="fa fa-check"></i><b>10.2.4</b> Definiendo el modelo multinivel.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="proceso-de-estimación-y-predicción-1.html"><a href="proceso-de-estimación-y-predicción-1.html"><i class="fa fa-check"></i><b>10.3</b> Proceso de estimación y predicción</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="proceso-de-estimación-y-predicción-1.html"><a href="proceso-de-estimación-y-predicción-1.html#distribución-posterior.-2"><i class="fa fa-check"></i><b>10.3.1</b> Distribución posterior.</a></li>
<li class="chapter" data-level="10.3.2" data-path="proceso-de-estimación-y-predicción-1.html"><a href="proceso-de-estimación-y-predicción-1.html#estimación-de-la-tasa-de-pobreza"><i class="fa fa-check"></i><b>10.3.2</b> Estimación de la tasa de pobreza</a></li>
<li class="chapter" data-level="10.3.3" data-path="proceso-de-estimación-y-predicción-1.html"><a href="proceso-de-estimación-y-predicción-1.html#estimación-para-el-dam-05.-2"><i class="fa fa-check"></i><b>10.3.3</b> Estimación para el dam == “05”.</a></li>
<li class="chapter" data-level="10.3.4" data-path="proceso-de-estimación-y-predicción-1.html"><a href="proceso-de-estimación-y-predicción-1.html#estimación-para-la-dam2-05001-2"><i class="fa fa-check"></i><b>10.3.4</b> Estimación para la dam2 == “05001”</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="día-3---sesión-4--modelo-de-área-para-estadísticas-del-mercado-de-trabajo.html"><a href="día-3---sesión-4--modelo-de-área-para-estadísticas-del-mercado-de-trabajo.html"><i class="fa fa-check"></i><b>11</b> Día 3 - Sesión 4- Modelo de área para estadísticas del mercado de trabajo</a>
<ul>
<li class="chapter" data-level="11.1" data-path="definición-del-modelo-multinomial.html"><a href="definición-del-modelo-multinomial.html"><i class="fa fa-check"></i><b>11.1</b> Definición del modelo multinomial</a></li>
<li class="chapter" data-level="11.2" data-path="lectura-de-librerías..html"><a href="lectura-de-librerías..html"><i class="fa fa-check"></i><b>11.2</b> Lectura de librerías.</a></li>
<li class="chapter" data-level="11.3" data-path="lectura-de-la-encuesta-y-estimaciones-directas.html"><a href="lectura-de-la-encuesta-y-estimaciones-directas.html"><i class="fa fa-check"></i><b>11.3</b> Lectura de la encuesta y estimaciones directas</a></li>
<li class="chapter" data-level="11.4" data-path="selección-de-dominios.html"><a href="selección-de-dominios.html"><i class="fa fa-check"></i><b>11.4</b> Selección de dominios</a></li>
<li class="chapter" data-level="11.5" data-path="modelo-programando-en-stan.html"><a href="modelo-programando-en-stan.html"><i class="fa fa-check"></i><b>11.5</b> Modelo programando en <code>STAN</code></a></li>
<li class="chapter" data-level="11.6" data-path="preparando-insumos-para-stan.html"><a href="preparando-insumos-para-stan.html"><i class="fa fa-check"></i><b>11.6</b> Preparando insumos para <code>STAN</code></a></li>
<li class="chapter" data-level="11.7" data-path="validación-del-modelo.html"><a href="validación-del-modelo.html"><i class="fa fa-check"></i><b>11.7</b> Validación del modelo</a></li>
<li class="chapter" data-level="11.8" data-path="estimación-de-los-parámetros..html"><a href="estimación-de-los-parámetros..html"><i class="fa fa-check"></i><b>11.8</b> Estimación de los parámetros.</a></li>
<li class="chapter" data-level="11.9" data-path="estimación-de-la-desviación-estárdar-y-el-coeficiente-de-valiación.html"><a href="estimación-de-la-desviación-estárdar-y-el-coeficiente-de-valiación.html"><i class="fa fa-check"></i><b>11.9</b> Estimación de la desviación estárdar y el coeficiente de valiación</a></li>
<li class="chapter" data-level="11.10" data-path="metodología-de-benchmarking.html"><a href="metodología-de-benchmarking.html"><i class="fa fa-check"></i><b>11.10</b> Metodología de Benchmarking</a></li>
<li class="chapter" data-level="11.11" data-path="mapas-del-mercado-de-trabajo..html"><a href="mapas-del-mercado-de-trabajo..html"><i class="fa fa-check"></i><b>11.11</b> Mapas del mercado de trabajo.</a>
<ul>
<li class="chapter" data-level="" data-path="mapas-del-mercado-de-trabajo..html"><a href="mapas-del-mercado-de-trabajo..html#ocupado-1"><i class="fa fa-check"></i>Ocupado</a></li>
<li class="chapter" data-level="" data-path="mapas-del-mercado-de-trabajo..html"><a href="mapas-del-mercado-de-trabajo..html#desocupado-1"><i class="fa fa-check"></i>Desocupado</a></li>
<li class="chapter" data-level="" data-path="mapas-del-mercado-de-trabajo..html"><a href="mapas-del-mercado-de-trabajo..html#inactivo-1"><i class="fa fa-check"></i>Inactivo</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a Taller de instalación de capacidades en SAE </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-sintéticos-simples" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Modelos sintéticos simples<a href="modelos-sintéticos-simples.html#modelos-sintéticos-simples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regla-de-bayes" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Regla de Bayes<a href="modelos-sintéticos-simples.html#regla-de-bayes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En términos de inferencia para <span class="math inline">\(\boldsymbol{\theta}\)</span>, es necesario encontrar la distribución de los parámetros condicionada a la observación de los datos. Para este fin, es necesario definir la distribución conjunta de la variable de interés con el vector de parámetros.</p>
<p><span class="math display">\[
p(\boldsymbol{\theta},\mathbf{Y})=p(\boldsymbol{\theta})p(\mathbf{Y} \mid \boldsymbol{\theta})
\]</span></p>
<ul>
<li><p>La distribución <span class="math inline">\(p(\boldsymbol{\theta})\)</span> se le conoce con el nombre de distribución previa.</p></li>
<li><p>El término <span class="math inline">\(p(\mathbf{Y} \mid \boldsymbol{\theta})\)</span> es la distribución de muestreo, verosimilitud o distribución de los datos.</p></li>
<li><p>La distribución del vector de parámetros condicionada a los datos observados está dada por</p>
<p><span class="math display">\[
p(\boldsymbol{\theta} \mid \mathbf{Y})=\frac{p(\boldsymbol{\theta},\mathbf{Y})}{p(\mathbf{Y})}=\frac{p(\boldsymbol{\theta})p(\mathbf{Y} \mid \boldsymbol{\theta})}{p(\mathbf{Y})}
\]</span></p></li>
<li><p>A la distribución <span class="math inline">\(p(\boldsymbol{\theta} \mid \mathbf{Y})\)</span> se le conoce con el nombre de distribución <strong><em>posterior</em></strong>. Nótese que el denominador no depende del vector de parámetros y considerando a los datos observados como fijos, corresponde a una constante y puede ser obviada. Por lo tanto, otra representación de la regla de Bayes está dada por</p>
<p><span class="math display">\[
p(\boldsymbol{\theta} \mid \mathbf{Y})\propto p(\mathbf{Y} \mid \boldsymbol{\theta})p(\boldsymbol{\theta})
\]</span></p></li>
</ul>
</div>
<div id="inferencia-bayesiana." class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Inferencia Bayesiana.<a href="modelos-sintéticos-simples.html#inferencia-bayesiana." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En términos de estimación, inferencia y predicción, el enfoque Bayesiano supone dos momentos o etapas:</p>
<ol style="list-style-type: decimal">
<li><strong>Antes de la recolección de las datos</strong>, en donde el investigador propone, basado en su conocimiento, experiencia o fuentes externas, una distribución de probabilidad previa para el parámetro de interés.</li>
<li><strong>Después de la recolección de los datos.</strong> Siguiendo el teorema de Bayes, el investigador actualiza su conocimiento acerca del comportamiento probabilístico del parámetro de interés mediante la distribución posterior de este.</li>
</ol>
</div>
<div id="modelos-uniparamétricos" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Modelos uniparamétricos<a href="modelos-sintéticos-simples.html#modelos-uniparamétricos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los modelos que están definidos en términos de un solo parámetro que pertenece al conjunto de los números reales se definen como modelos <em>uniparamétricos</em>.</p>
<div id="modelo-de-unidad-bernoulli" class="section level4 hasAnchor" number="3.1.3.1">
<h4><span class="header-section-number">3.1.3.1</span> Modelo de unidad: Bernoulli<a href="modelos-sintéticos-simples.html#modelo-de-unidad-bernoulli" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suponga que <span class="math inline">\(Y\)</span> es una variable aleatoria con distribución Bernoulli dada por:</p>
<p><span class="math display">\[
p(Y \mid \theta)=\theta^y(1-\theta)^{1-y}I_{\{0,1\}}(y)
\]</span></p>
<p>Como el parámetro <span class="math inline">\(\theta\)</span> está restringido al espacio <span class="math inline">\(\Theta=[0,1]\)</span>, entonces es posible formular varias opciones para la distribución previa del parámetro. En particular, la distribución uniforme restringida al intervalo <span class="math inline">\([0,1]\)</span> o la distribución Beta parecen ser buenas opciones. Puesto que la distribución uniforme es un caso particular de la distribución Beta. Por lo tanto la distribución previa del parámetro <span class="math inline">\(\theta\)</span> estará dada por</p>
<p><span class="math display">\[
\begin{equation}
p(\theta \mid \alpha,\beta)=
\frac{1}{Beta(\alpha,\beta)}\theta^{\alpha-1}(1-\theta)^{\beta-1}I_{[0,1]}(\theta).
\end{equation}
\]</span></p>
<p>y la distribución posterior del parámetro <span class="math inline">\(\theta\)</span> sigue una distribución</p>
<p><span class="math display">\[
\begin{equation*}
\theta \mid Y \sim Beta(y+\alpha,\beta-y+1)
\end{equation*}
\]</span></p>
<p>Cuando se tiene una muestra aleatoria <span class="math inline">\(Y_1,\ldots,Y_n\)</span> de variables con distribución Bernoulli de parámetro <span class="math inline">\(\theta\)</span>, entonces la distribución posterior del parámetro de interés es</p>
<p><span class="math display">\[
\begin{equation*}
\theta \mid Y_1,\ldots,Y_n \sim Beta\left(\sum_{i=1}^ny_i+\alpha,\beta-\sum_{i=1}^ny_i+n\right)
\end{equation*}
\]</span></p>
<div id="objetivo" class="section level5 unnumbered hasAnchor">
<h5>Objetivo<a href="modelos-sintéticos-simples.html#objetivo" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Estimar la proporción de personas que están por debajo de la linea pobreza, es decir,
<span class="math display">\[
P_d = \frac{\sum_{U_d}y_{di}}{N_d}
\]</span>
donde <span class="math inline">\(y_{di}\)</span> toma el valor de 1 cuando el ingreso de la persona es menor a la linea de pobreza 0 en caso contrario.</p>
<p>Note que,</p>
<p><span class="math display">\[
\begin{equation*}
\bar{Y}_d = P_d =  \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}y_{di}}{N_d}
\end{equation*}
\]</span></p>
<p>Ahora, el estimador de <span class="math inline">\(P\)</span> esta dado por:</p>
<p><span class="math display">\[
\hat{P} = \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}\hat{y}_{di}}{N_d}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[\hat{y}_{di}=E_{\mathscr{M}}\left(y_{di}\mid\boldsymbol{x}_{d},\boldsymbol{\beta}\right)\]</span>,</p>
<p>donde <span class="math inline">\(\mathscr{M}\)</span> hace referencia a la medida de probabilidad inducida por el modelamiento.
De esta forma se tiene que,</p>
<p><span class="math display">\[
\hat{P} = \frac{\sum_{U_{d}}\hat{y}_{di}}{N_d}
\]</span></p>
</div>
<div id="práctica-en-r" class="section level5 hasAnchor" number="3.1.3.1.1">
<h5><span class="header-section-number">3.1.3.1.1</span> Práctica en <strong>R</strong><a href="modelos-sintéticos-simples.html#práctica-en-r" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="modelos-sintéticos-simples.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-2"><a href="modelos-sintéticos-simples.html#cb15-2" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/Día1/Sesion3/Data/encuestaMEX20N1.Rds&quot;</span>) </span></code></pre></div>
<p>Sea <span class="math inline">\(Y\)</span> la variable aleatoria</p>
<p><span class="math display">\[
Y_{i}=\begin{cases}
1 &amp; ingreso&lt;lp\\
0 &amp; ingreso\geq lp
\end{cases}
\]</span></p>
<p>El tamaño de la muestra es de 19016 Indígena</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="modelos-sintéticos-simples.html#cb16-1" tabindex="-1"></a>datay <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(etnia_ee <span class="sc">==</span> <span class="dv">1</span>, discapacidad <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="modelos-sintéticos-simples.html#cb16-2" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">y =</span> <span class="fu">ifelse</span>(ingcorte <span class="sc">&lt;</span> lp, <span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb16-3"><a href="modelos-sintéticos-simples.html#cb16-3" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(datay<span class="sc">$</span>y)) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Var1
</th>
<th style="text-align:right;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
11770
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
7246
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
19016
</td>
</tr>
</tbody>
</table>
<p>Un grupo de estadístico experto decide utilizar una distribución previa Beta, definiendo los parámetros de la distribución previa como <span class="math inline">\(Beta(\alpha=1, \beta=1)\)</span>. La distribución posterior del parámetro de interés, que representa la probabilidad de estar por debajo de la linea de pobreza, es <span class="math inline">\(Beta(7246 + 1, 1 - 7246 + 19016)=Beta(7247, 1.1771\times 10^{4})\)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Bernoulli/Bernoulli1.png" alt="Distribución previa (línea roja) y distribución posterior (línea negra)" width="500px" height="250px" />
<p class="caption">
Figura 3.1: Distribución previa (línea roja) y distribución posterior (línea negra)
</p>
</div>
<p>La estimación del parámetro estaría dado por:</p>
<p><span class="math display">\[
E(X) = \frac{\alpha}{\alpha + \beta} = \frac{7247}{7247+ 1.1771\times 10^{4}} = 0.38106
\]</span></p>
<p>luego, el intervalo de credibilidad para la distribución posterior es.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="modelos-sintéticos-simples.html#cb17-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(datay<span class="sc">$</span>y)</span>
<span id="cb17-2"><a href="modelos-sintéticos-simples.html#cb17-2" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="fu">sum</span>(datay<span class="sc">$</span>y)</span>
<span id="cb17-3"><a href="modelos-sintéticos-simples.html#cb17-3" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>),</span>
<span id="cb17-4"><a href="modelos-sintéticos-simples.html#cb17-4" tabindex="-1"></a>      <span class="at">shape1 =</span> <span class="dv">1</span> <span class="sc">+</span> n1,</span>
<span id="cb17-5"><a href="modelos-sintéticos-simples.html#cb17-5" tabindex="-1"></a>      <span class="at">shape2 =</span> <span class="dv">1</span> <span class="sc">-</span> n1 <span class="sc">+</span> n)</span></code></pre></div>
<pre><code>## [1] 0.3741700 0.3879738</code></pre>
</div>
<div id="práctica-en-stan" class="section level5 hasAnchor" number="3.1.3.1.2">
<h5><span class="header-section-number">3.1.3.1.2</span> Práctica en <strong>STAN</strong><a href="modelos-sintéticos-simples.html#práctica-en-stan" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>En <code>STAN</code> es posible obtener el mismo tipo de inferencia creando cuatro cadenas cuya distribución de probabilidad coincide con la distribución posterior del ejemplo.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="modelos-sintéticos-simples.html#cb19-1" tabindex="-1"></a>data {                         <span class="sc">/</span><span class="er">/</span> Entrada el modelo </span>
<span id="cb19-2"><a href="modelos-sintéticos-simples.html#cb19-2" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;              <span class="sc">/</span><span class="er">/</span> Numero de observaciones  </span>
<span id="cb19-3"><a href="modelos-sintéticos-simples.html#cb19-3" tabindex="-1"></a>  int y[n];                    <span class="sc">/</span><span class="er">/</span> Vector de longitud n</span>
<span id="cb19-4"><a href="modelos-sintéticos-simples.html#cb19-4" tabindex="-1"></a>  real a;</span>
<span id="cb19-5"><a href="modelos-sintéticos-simples.html#cb19-5" tabindex="-1"></a>  real b;</span>
<span id="cb19-6"><a href="modelos-sintéticos-simples.html#cb19-6" tabindex="-1"></a>}</span>
<span id="cb19-7"><a href="modelos-sintéticos-simples.html#cb19-7" tabindex="-1"></a>parameters {                   <span class="sc">/</span><span class="er">/</span> Definir parámetro</span>
<span id="cb19-8"><a href="modelos-sintéticos-simples.html#cb19-8" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>, upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> theta;</span>
<span id="cb19-9"><a href="modelos-sintéticos-simples.html#cb19-9" tabindex="-1"></a>}</span>
<span id="cb19-10"><a href="modelos-sintéticos-simples.html#cb19-10" tabindex="-1"></a>model {                        <span class="sc">/</span><span class="er">/</span> Definir modelo</span>
<span id="cb19-11"><a href="modelos-sintéticos-simples.html#cb19-11" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">bernoulli</span>(theta);</span>
<span id="cb19-12"><a href="modelos-sintéticos-simples.html#cb19-12" tabindex="-1"></a>  theta <span class="sc">~</span> <span class="fu">beta</span>(a, b);      <span class="sc">/</span><span class="er">/</span> Distribución previa </span>
<span id="cb19-13"><a href="modelos-sintéticos-simples.html#cb19-13" tabindex="-1"></a>}</span>
<span id="cb19-14"><a href="modelos-sintéticos-simples.html#cb19-14" tabindex="-1"></a>generated quantities {</span>
<span id="cb19-15"><a href="modelos-sintéticos-simples.html#cb19-15" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb19-16"><a href="modelos-sintéticos-simples.html#cb19-16" tabindex="-1"></a>    <span class="cf">for</span> (ii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb19-17"><a href="modelos-sintéticos-simples.html#cb19-17" tabindex="-1"></a>    ypred[ii] <span class="ot">=</span> <span class="fu">bernoulli_rng</span>(theta);</span>
<span id="cb19-18"><a href="modelos-sintéticos-simples.html#cb19-18" tabindex="-1"></a>    }</span>
<span id="cb19-19"><a href="modelos-sintéticos-simples.html#cb19-19" tabindex="-1"></a>}</span></code></pre></div>
<p>Para compilar <em>STAN</em> debemos definir los parámetros de entrada</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="modelos-sintéticos-simples.html#cb20-1" tabindex="-1"></a>    sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datay),</span>
<span id="cb20-2"><a href="modelos-sintéticos-simples.html#cb20-2" tabindex="-1"></a>                        <span class="at">y =</span> datay<span class="sc">$</span>y,</span>
<span id="cb20-3"><a href="modelos-sintéticos-simples.html#cb20-3" tabindex="-1"></a>                        <span class="at">a =</span> <span class="dv">1</span>,</span>
<span id="cb20-4"><a href="modelos-sintéticos-simples.html#cb20-4" tabindex="-1"></a>                        <span class="at">b =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>rstan</em></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="modelos-sintéticos-simples.html#cb21-1" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb21-2"><a href="modelos-sintéticos-simples.html#cb21-2" tabindex="-1"></a>Bernoulli <span class="ot">&lt;-</span> <span class="st">&quot;Recursos/Día1/Sesion3/Data/modelosStan/1Bernoulli.stan&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="modelos-sintéticos-simples.html#cb22-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb22-2"><a href="modelos-sintéticos-simples.html#cb22-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>) <span class="co"># speed up running time </span></span>
<span id="cb22-3"><a href="modelos-sintéticos-simples.html#cb22-3" tabindex="-1"></a>model_Bernoulli <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb22-4"><a href="modelos-sintéticos-simples.html#cb22-4" tabindex="-1"></a>  <span class="at">file =</span> Bernoulli,  <span class="co"># Stan program</span></span>
<span id="cb22-5"><a href="modelos-sintéticos-simples.html#cb22-5" tabindex="-1"></a>  <span class="at">data =</span> sample_data,    <span class="co"># named list of data</span></span>
<span id="cb22-6"><a href="modelos-sintéticos-simples.html#cb22-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-7"><a href="modelos-sintéticos-simples.html#cb22-7" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">500</span>,          <span class="co"># number of warmup iterations per chain</span></span>
<span id="cb22-8"><a href="modelos-sintéticos-simples.html#cb22-8" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">1000</span>,            <span class="co"># total number of iterations per chain</span></span>
<span id="cb22-9"><a href="modelos-sintéticos-simples.html#cb22-9" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,              <span class="co"># number of cores (could use one per chain)</span></span>
<span id="cb22-10"><a href="modelos-sintéticos-simples.html#cb22-10" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="modelos-sintéticos-simples.html#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="modelos-sintéticos-simples.html#cb22-12" tabindex="-1"></a><span class="fu">saveRDS</span>(model_Bernoulli,</span>
<span id="cb22-13"><a href="modelos-sintéticos-simples.html#cb22-13" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Bernoulli/model_Bernoulli.rds&quot;</span>)</span>
<span id="cb22-14"><a href="modelos-sintéticos-simples.html#cb22-14" tabindex="-1"></a></span>
<span id="cb22-15"><a href="modelos-sintéticos-simples.html#cb22-15" tabindex="-1"></a>model_Bernoulli <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Bernoulli/model_Bernoulli.rds&quot;</span>)</span></code></pre></div>
<p>La estimación del parámetro <span class="math inline">\(\theta\)</span> es:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="modelos-sintéticos-simples.html#cb23-1" tabindex="-1"></a>tabla_Ber1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_Bernoulli, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)<span class="sc">$</span>summary</span>
<span id="cb23-2"><a href="modelos-sintéticos-simples.html#cb23-2" tabindex="-1"></a>tabla_Ber1 <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
theta
</td>
<td style="text-align:right;">
0.3812
</td>
<td style="text-align:right;">
2e-04
</td>
<td style="text-align:right;">
0.0036
</td>
<td style="text-align:right;">
0.3741
</td>
<td style="text-align:right;">
0.3788
</td>
<td style="text-align:right;">
0.3811
</td>
<td style="text-align:right;">
0.3835
</td>
<td style="text-align:right;">
0.3885
</td>
<td style="text-align:right;">
572.8452
</td>
<td style="text-align:right;">
1.002
</td>
</tr>
</tbody>
</table>
<p>Para observar las cadenas compilamos las lineas de código</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="modelos-sintéticos-simples.html#cb24-1" tabindex="-1"></a><span class="fu">library</span>(posterior) </span>
<span id="cb24-2"><a href="modelos-sintéticos-simples.html#cb24-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-3"><a href="modelos-sintéticos-simples.html#cb24-3" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(<span class="fu">as.array</span>(model_Bernoulli,<span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>))</span>
<span id="cb24-4"><a href="modelos-sintéticos-simples.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="modelos-sintéticos-simples.html#cb24-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> temp, <span class="fu">aes</span>(<span class="at">x =</span> theta))<span class="sc">+</span> </span>
<span id="cb24-6"><a href="modelos-sintéticos-simples.html#cb24-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="modelos-sintéticos-simples.html#cb24-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> posterior1,</span>
<span id="cb24-8"><a href="modelos-sintéticos-simples.html#cb24-8" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">y =</span> datay<span class="sc">$</span>y),</span>
<span id="cb24-9"><a href="modelos-sintéticos-simples.html#cb24-9" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb24-10"><a href="modelos-sintéticos-simples.html#cb24-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span> </span>
<span id="cb24-11"><a href="modelos-sintéticos-simples.html#cb24-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">theta&quot;</span>),</span>
<span id="cb24-12"><a href="modelos-sintéticos-simples.html#cb24-12" tabindex="-1"></a>       <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;f(</span><span class="sc">\\</span><span class="st">theta)&quot;</span>))</span>
<span id="cb24-13"><a href="modelos-sintéticos-simples.html#cb24-13" tabindex="-1"></a>  <span class="co"># ggsave(plot = p1, filename = &quot;Recursos/Día1/Sesion3/0Recursos/Bernoulli/Bernoulli2.png&quot;, scale = 2)</span></span>
<span id="cb24-14"><a href="modelos-sintéticos-simples.html#cb24-14" tabindex="-1"></a>p1 </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Bernoulli/Bernoulli2.png" alt="Resultado con STAN (línea azul) y posterior teórica (línea negra)" width="500px" height="250px" />
<p class="caption">
Figura 3.2: Resultado con STAN (línea azul) y posterior teórica (línea negra)
</p>
</div>
<p>Para validar las cadenas</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="modelos-sintéticos-simples.html#cb25-1" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb25-2"><a href="modelos-sintéticos-simples.html#cb25-2" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb25-3"><a href="modelos-sintéticos-simples.html#cb25-3" tabindex="-1"></a>posterior_theta <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Bernoulli, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)</span>
<span id="cb25-4"><a href="modelos-sintéticos-simples.html#cb25-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_theta) <span class="sc">+</span></span>
<span id="cb25-5"><a href="modelos-sintéticos-simples.html#cb25-5" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_theta) ) <span class="sc">/</span> </span>
<span id="cb25-6"><a href="modelos-sintéticos-simples.html#cb25-6" tabindex="-1"></a><span class="fu">traceplot</span>(model_Bernoulli,<span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>, <span class="at">inc_warmup =</span> <span class="cn">TRUE</span>) </span>
<span id="cb25-7"><a href="modelos-sintéticos-simples.html#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="modelos-sintéticos-simples.html#cb25-8" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb25-9"><a href="modelos-sintéticos-simples.html#cb25-9" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Bernoulli/Bernoulli3.png&quot;, scale = 2)</span></span>
<span id="cb25-10"><a href="modelos-sintéticos-simples.html#cb25-10" tabindex="-1"></a>p1  </span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Bernoulli/Bernoulli3.png" width="200%" style="display: block; margin: auto;" /></p>
<p>Predicción de <span class="math inline">\(Y\)</span> en cada una de las iteraciones de las cadenas.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="modelos-sintéticos-simples.html#cb26-1" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Bernoulli, <span class="at">pars =</span> <span class="st">&quot;ypred&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="modelos-sintéticos-simples.html#cb26-2" tabindex="-1"></a>  <span class="fu">as_draws_matrix</span>()</span>
<span id="cb26-3"><a href="modelos-sintéticos-simples.html#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="modelos-sintéticos-simples.html#cb26-4" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb26-5"><a href="modelos-sintéticos-simples.html#cb26-5" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, <span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb26-6"><a href="modelos-sintéticos-simples.html#cb26-6" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> datay<span class="sc">$</span>y, y_pred2)</span>
<span id="cb26-7"><a href="modelos-sintéticos-simples.html#cb26-7" tabindex="-1"></a> <span class="co"># ggsave(plot = p1,</span></span>
<span id="cb26-8"><a href="modelos-sintéticos-simples.html#cb26-8" tabindex="-1"></a> <span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Bernoulli/Bernoulli4.png&quot;, scale = 2)</span></span>
<span id="cb26-9"><a href="modelos-sintéticos-simples.html#cb26-9" tabindex="-1"></a>p1 </span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Bernoulli/Bernoulli4.png" width="200%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="modelo-de-área-binomial" class="section level4 hasAnchor" number="3.1.3.2">
<h4><span class="header-section-number">3.1.3.2</span> Modelo de área: Binomial<a href="modelos-sintéticos-simples.html#modelo-de-área-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Cuando se dispone de una muestra aleatoria de variables con distribución Bernoulli <span class="math inline">\(Y_1,\ldots,Y_n\)</span>, la inferencia Bayesiana se puede llevar a cabo usando la distribución Binomial, puesto que es bien sabido que la suma de variables aleatorias Bernoulli</p>
<p><span class="math display">\[
\begin{equation*}
S=\sum_{i=1}^nY_i
\end{equation*}
\]</span></p>
<p>sigue una distribución Binomial. Es decir:</p>
<p><span class="math display">\[
\begin{equation}
p(S \mid \theta)=\binom{n}{s}\theta^s(1-\theta)^{n-s}I_{\{0,1,\ldots,n\}}(s),
\end{equation}
\]</span></p>
<p>Nótese que, cuando <span class="math inline">\(n=1\)</span> la distribución Binomial se convierte en una distribución Bernoulli. Puesto que, el parámetro <span class="math inline">\(\theta\)</span> es una proporción la distribución natural que modela este tipo de parámetros es la distribución beta la cual se define como:</p>
<p><span class="math display">\[
\begin{equation}
p(\theta \mid \alpha,\beta)=
\frac{1}{Beta(\alpha,\beta)}\theta^{\alpha-1}(1-\theta)^{\beta-1}I_{[0,1]}(\theta).
\end{equation}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\theta\)</span> sigue una distribución</p>
<p><span class="math display">\[
\begin{equation*}
\theta \mid S \sim Beta(s+\alpha,\beta-s+n)
\end{equation*}
\]</span></p>
<p>Ahora, cuando se tiene una sucesión de variables aleatorias <span class="math inline">\(S_1,\ldots,S_d, \ldots,S_D\)</span> independientes y con distribución <span class="math inline">\(Binomial(n_d,\theta_d)\)</span> para <span class="math inline">\(d=1,\ldots,D\)</span>. La distribución posterior del parámetro de interés <span class="math inline">\(\theta_d\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\theta_d \mid s_d \sim Beta\left(s_d+\alpha,\ \beta+ n_d- s_d\right)
\end{equation*}
\]</span></p>
<div id="objetivo-1" class="section level5 unnumbered hasAnchor">
<h5>Objetivo<a href="modelos-sintéticos-simples.html#objetivo-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Estimar la proporción de personas que están por debajo de la linea pobreza, es decir,</p>
<p><span class="math display">\[P_{d}=\frac{\sum_{U}y_{di}}{N_{d}}\]</span>.</p>
<p>Un estimador aproximadamente insesgado para <span class="math inline">\(P_{d}\)</span> basado en el diseño muestral es
<span class="math display">\[
\hat{P}^{DIR}_{d} = \frac{\sum_{s_{d}}w_{di}y_{di}}{\sum_{s_{d}}w_{di}}
\]</span></p>
<p>donde <span class="math inline">\(w_{di}\)</span> es el factor de expansión de <span class="math inline">\(i-\)</span>ésimo individuo
en el <span class="math inline">\(d-\)</span>ésimo dominio y <span class="math inline">\(y_{di}\)</span> toma los valores de uno o cero.</p>
<p>Ahora, dada la naturaleza de <span class="math inline">\(P_d\)</span>, es posible asumir que <span class="math inline">\(P_{d}\mid\hat{P}^{DIR}_{d} \sim Beta(\alpha,\beta)\)</span>. Luego, el estimador bayesiano para <span class="math inline">\(P_{d}\)</span> esta dado por <span class="math inline">\(\tilde{P}_{d}=E\left(P_{d}\mid\hat{P}^{DIR}_{d}\right)\)</span>
y la varianza del estimador se obtiene como:</p>
<p><span class="math display">\[
Var\left(\tilde{P}_{d}\right) =  Var\left(P_{d}\mid\hat{P}_{d}\right)=E_{\mathscr{M}}\left(Var_{\mathscr{P}}\left(P_{d}\mid\hat{P}_{d}\right)\right)+Var_{\mathscr{M}}\left(E_{\mathscr{P}}\left(P_{d}\mid\hat{P}_{d}\right)\right)
\]</span></p>
</div>
<div id="práctica-en-stan-1" class="section level5 hasAnchor" number="3.1.3.2.1">
<h5><span class="header-section-number">3.1.3.2.1</span> Práctica en <strong>STAN</strong><a href="modelos-sintéticos-simples.html#práctica-en-stan-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sea <span class="math inline">\(S_k\)</span> el conteo de personas en condición de pobreza en el <span class="math inline">\(k-ésimo\)</span> departamento en la muestra.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="modelos-sintéticos-simples.html#cb27-1" tabindex="-1"></a>dataS <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="modelos-sintéticos-simples.html#cb27-2" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb27-3"><a href="modelos-sintéticos-simples.html#cb27-3" tabindex="-1"></a>  dam,  <span class="at">y =</span> <span class="fu">ifelse</span>(ingcorte <span class="sc">&lt;</span> lp, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb27-4"><a href="modelos-sintéticos-simples.html#cb27-4" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="modelos-sintéticos-simples.html#cb27-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nd =</span> <span class="fu">n</span>(),   <span class="co">#Número de ensayos </span></span>
<span id="cb27-6"><a href="modelos-sintéticos-simples.html#cb27-6" tabindex="-1"></a>            <span class="at">Sd =</span> <span class="fu">sum</span>(y) <span class="co">#Número de éxito </span></span>
<span id="cb27-7"><a href="modelos-sintéticos-simples.html#cb27-7" tabindex="-1"></a>            )</span>
<span id="cb27-8"><a href="modelos-sintéticos-simples.html#cb27-8" tabindex="-1"></a><span class="fu">tba</span>(dataS)</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
dam
</th>
<th style="text-align:right;">
nd
</th>
<th style="text-align:right;">
Sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
01
</td>
<td style="text-align:right;">
10046
</td>
<td style="text-align:right;">
2506
</td>
</tr>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:right;">
13930
</td>
<td style="text-align:right;">
2284
</td>
</tr>
<tr>
<td style="text-align:left;">
03
</td>
<td style="text-align:right;">
8877
</td>
<td style="text-align:right;">
1661
</td>
</tr>
<tr>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
7783
</td>
<td style="text-align:right;">
3318
</td>
</tr>
<tr>
<td style="text-align:left;">
05
</td>
<td style="text-align:right;">
13692
</td>
<td style="text-align:right;">
3730
</td>
</tr>
<tr>
<td style="text-align:left;">
06
</td>
<td style="text-align:right;">
10614
</td>
<td style="text-align:right;">
2280
</td>
</tr>
<tr>
<td style="text-align:left;">
07
</td>
<td style="text-align:right;">
8288
</td>
<td style="text-align:right;">
5540
</td>
</tr>
<tr>
<td style="text-align:left;">
08
</td>
<td style="text-align:right;">
15014
</td>
<td style="text-align:right;">
4014
</td>
</tr>
<tr>
<td style="text-align:left;">
09
</td>
<td style="text-align:right;">
9056
</td>
<td style="text-align:right;">
2430
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
10113
</td>
<td style="text-align:right;">
3826
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
11895
</td>
<td style="text-align:right;">
3943
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
9254
</td>
<td style="text-align:right;">
5438
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:right;">
7820
</td>
<td style="text-align:right;">
3167
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
9976
</td>
<td style="text-align:right;">
2763
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
13649
</td>
<td style="text-align:right;">
6112
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
7484
</td>
<td style="text-align:right;">
2747
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
8741
</td>
<td style="text-align:right;">
3531
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:right;">
6981
</td>
<td style="text-align:right;">
1706
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:right;">
12003
</td>
<td style="text-align:right;">
2777
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:right;">
9519
</td>
<td style="text-align:right;">
4981
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:right;">
8145
</td>
<td style="text-align:right;">
4603
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:right;">
13851
</td>
<td style="text-align:right;">
3492
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:right;">
7537
</td>
<td style="text-align:right;">
3347
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:right;">
9344
</td>
<td style="text-align:right;">
3768
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:right;">
11886
</td>
<td style="text-align:right;">
2774
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:right;">
8137
</td>
<td style="text-align:right;">
2116
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:right;">
7316
</td>
<td style="text-align:right;">
3204
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:right;">
7756
</td>
<td style="text-align:right;">
2741
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:right;">
8490
</td>
<td style="text-align:right;">
4508
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:right;">
9367
</td>
<td style="text-align:right;">
4927
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:right;">
10319
</td>
<td style="text-align:right;">
4693
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:right;">
8860
</td>
<td style="text-align:right;">
3576
</td>
</tr>
</tbody>
</table>
<p>Creando código de <code>STAN</code></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="modelos-sintéticos-simples.html#cb28-1" tabindex="-1"></a>data {</span>
<span id="cb28-2"><a href="modelos-sintéticos-simples.html#cb28-2" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;                 <span class="sc">/</span><span class="er">/</span> Número de provincia  </span>
<span id="cb28-3"><a href="modelos-sintéticos-simples.html#cb28-3" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n[K];              <span class="sc">/</span><span class="er">/</span> Número de ensayos </span>
<span id="cb28-4"><a href="modelos-sintéticos-simples.html#cb28-4" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> s[K];              <span class="sc">/</span><span class="er">/</span> Número de éxitos</span>
<span id="cb28-5"><a href="modelos-sintéticos-simples.html#cb28-5" tabindex="-1"></a>  real a;</span>
<span id="cb28-6"><a href="modelos-sintéticos-simples.html#cb28-6" tabindex="-1"></a>  real b;</span>
<span id="cb28-7"><a href="modelos-sintéticos-simples.html#cb28-7" tabindex="-1"></a>}</span>
<span id="cb28-8"><a href="modelos-sintéticos-simples.html#cb28-8" tabindex="-1"></a>parameters {</span>
<span id="cb28-9"><a href="modelos-sintéticos-simples.html#cb28-9" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>, upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> theta[K]; <span class="sc">/</span><span class="er">/</span> theta_d<span class="sc">|</span>s_d</span>
<span id="cb28-10"><a href="modelos-sintéticos-simples.html#cb28-10" tabindex="-1"></a>}</span>
<span id="cb28-11"><a href="modelos-sintéticos-simples.html#cb28-11" tabindex="-1"></a>model {</span>
<span id="cb28-12"><a href="modelos-sintéticos-simples.html#cb28-12" tabindex="-1"></a>  <span class="cf">for</span>(kk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb28-13"><a href="modelos-sintéticos-simples.html#cb28-13" tabindex="-1"></a>  s[kk] <span class="sc">~</span> <span class="fu">binomial</span>(n[kk], theta[kk]);</span>
<span id="cb28-14"><a href="modelos-sintéticos-simples.html#cb28-14" tabindex="-1"></a>  }</span>
<span id="cb28-15"><a href="modelos-sintéticos-simples.html#cb28-15" tabindex="-1"></a>  <span class="fu">to_vector</span>(theta) <span class="sc">~</span> <span class="fu">beta</span>(a, b);</span>
<span id="cb28-16"><a href="modelos-sintéticos-simples.html#cb28-16" tabindex="-1"></a>}</span>
<span id="cb28-17"><a href="modelos-sintéticos-simples.html#cb28-17" tabindex="-1"></a></span>
<span id="cb28-18"><a href="modelos-sintéticos-simples.html#cb28-18" tabindex="-1"></a>generated quantities {</span>
<span id="cb28-19"><a href="modelos-sintéticos-simples.html#cb28-19" tabindex="-1"></a>    real spred[K];                    <span class="sc">/</span><span class="er">/</span> vector de longitud K</span>
<span id="cb28-20"><a href="modelos-sintéticos-simples.html#cb28-20" tabindex="-1"></a>    <span class="cf">for</span>(kk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb28-21"><a href="modelos-sintéticos-simples.html#cb28-21" tabindex="-1"></a>    spred[kk] <span class="ot">=</span> <span class="fu">binomial_rng</span>(n[kk],theta[kk]);</span>
<span id="cb28-22"><a href="modelos-sintéticos-simples.html#cb28-22" tabindex="-1"></a>}</span>
<span id="cb28-23"><a href="modelos-sintéticos-simples.html#cb28-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Preparando el código de <code>STAN</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="modelos-sintéticos-simples.html#cb29-1" tabindex="-1"></a>Binomial2 <span class="ot">&lt;-</span> <span class="st">&quot;Recursos/Día1/Sesion3/Data/modelosStan/3Binomial.stan&quot;</span></span></code></pre></div>
<p>Organizando datos para <code>STAN</code></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="modelos-sintéticos-simples.html#cb30-1" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">K =</span> <span class="fu">nrow</span>(dataS),</span>
<span id="cb30-2"><a href="modelos-sintéticos-simples.html#cb30-2" tabindex="-1"></a>                    <span class="at">s =</span> dataS<span class="sc">$</span>Sd,</span>
<span id="cb30-3"><a href="modelos-sintéticos-simples.html#cb30-3" tabindex="-1"></a>                    <span class="at">n =</span> dataS<span class="sc">$</span>nd,</span>
<span id="cb30-4"><a href="modelos-sintéticos-simples.html#cb30-4" tabindex="-1"></a>                    <span class="at">a =</span> <span class="dv">1</span>,</span>
<span id="cb30-5"><a href="modelos-sintéticos-simples.html#cb30-5" tabindex="-1"></a>                    <span class="at">b =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>rstan</em></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="modelos-sintéticos-simples.html#cb31-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb31-2"><a href="modelos-sintéticos-simples.html#cb31-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>) <span class="co"># speed up running time </span></span>
<span id="cb31-3"><a href="modelos-sintéticos-simples.html#cb31-3" tabindex="-1"></a>model_Binomial2 <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb31-4"><a href="modelos-sintéticos-simples.html#cb31-4" tabindex="-1"></a>  <span class="at">file =</span> Binomial2,  <span class="co"># Stan program</span></span>
<span id="cb31-5"><a href="modelos-sintéticos-simples.html#cb31-5" tabindex="-1"></a>  <span class="at">data =</span> sample_data,    <span class="co"># named list of data</span></span>
<span id="cb31-6"><a href="modelos-sintéticos-simples.html#cb31-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-7"><a href="modelos-sintéticos-simples.html#cb31-7" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">500</span>,          <span class="co"># number of warmup iterations per chain</span></span>
<span id="cb31-8"><a href="modelos-sintéticos-simples.html#cb31-8" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">1000</span>,            <span class="co"># total number of iterations per chain</span></span>
<span id="cb31-9"><a href="modelos-sintéticos-simples.html#cb31-9" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,              <span class="co"># number of cores (could use one per chain)</span></span>
<span id="cb31-10"><a href="modelos-sintéticos-simples.html#cb31-10" tabindex="-1"></a>)</span>
<span id="cb31-11"><a href="modelos-sintéticos-simples.html#cb31-11" tabindex="-1"></a></span>
<span id="cb31-12"><a href="modelos-sintéticos-simples.html#cb31-12" tabindex="-1"></a><span class="fu">saveRDS</span>(model_Binomial2, <span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Binomial/model_Binomial2.rds&quot;</span>)</span>
<span id="cb31-13"><a href="modelos-sintéticos-simples.html#cb31-13" tabindex="-1"></a>model_Binomial2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Binomial/model_Binomial2.rds&quot;</span>)</span></code></pre></div>
<p>La estimación del parámetro <span class="math inline">\(\theta\)</span> es:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="modelos-sintéticos-simples.html#cb32-1" tabindex="-1"></a>tabla_Bin1 <span class="ot">&lt;-</span><span class="fu">summary</span>(model_Binomial2, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)<span class="sc">$</span>summary </span>
<span id="cb32-2"><a href="modelos-sintéticos-simples.html#cb32-2" tabindex="-1"></a>tabla_Bin1 <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
theta[1]
</td>
<td style="text-align:right;">
0.2494
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0042
</td>
<td style="text-align:right;">
0.2412
</td>
<td style="text-align:right;">
0.2466
</td>
<td style="text-align:right;">
0.2495
</td>
<td style="text-align:right;">
0.2523
</td>
<td style="text-align:right;">
0.2573
</td>
<td style="text-align:right;">
4618.500
</td>
<td style="text-align:right;">
0.9992
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[2]
</td>
<td style="text-align:right;">
0.1640
</td>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0.0031
</td>
<td style="text-align:right;">
0.1581
</td>
<td style="text-align:right;">
0.1619
</td>
<td style="text-align:right;">
0.1641
</td>
<td style="text-align:right;">
0.1662
</td>
<td style="text-align:right;">
0.1701
</td>
<td style="text-align:right;">
4505.446
</td>
<td style="text-align:right;">
0.9988
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[3]
</td>
<td style="text-align:right;">
0.1872
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0041
</td>
<td style="text-align:right;">
0.1793
</td>
<td style="text-align:right;">
0.1846
</td>
<td style="text-align:right;">
0.1872
</td>
<td style="text-align:right;">
0.1900
</td>
<td style="text-align:right;">
0.1950
</td>
<td style="text-align:right;">
5256.099
</td>
<td style="text-align:right;">
0.9997
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[4]
</td>
<td style="text-align:right;">
0.4263
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0057
</td>
<td style="text-align:right;">
0.4149
</td>
<td style="text-align:right;">
0.4227
</td>
<td style="text-align:right;">
0.4263
</td>
<td style="text-align:right;">
0.4300
</td>
<td style="text-align:right;">
0.4375
</td>
<td style="text-align:right;">
4756.186
</td>
<td style="text-align:right;">
0.9990
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[5]
</td>
<td style="text-align:right;">
0.2725
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0037
</td>
<td style="text-align:right;">
0.2654
</td>
<td style="text-align:right;">
0.2700
</td>
<td style="text-align:right;">
0.2725
</td>
<td style="text-align:right;">
0.2749
</td>
<td style="text-align:right;">
0.2801
</td>
<td style="text-align:right;">
4265.075
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[6]
</td>
<td style="text-align:right;">
0.2148
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0042
</td>
<td style="text-align:right;">
0.2067
</td>
<td style="text-align:right;">
0.2120
</td>
<td style="text-align:right;">
0.2148
</td>
<td style="text-align:right;">
0.2177
</td>
<td style="text-align:right;">
0.2229
</td>
<td style="text-align:right;">
4798.561
</td>
<td style="text-align:right;">
0.9993
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[7]
</td>
<td style="text-align:right;">
0.6685
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0052
</td>
<td style="text-align:right;">
0.6581
</td>
<td style="text-align:right;">
0.6649
</td>
<td style="text-align:right;">
0.6686
</td>
<td style="text-align:right;">
0.6719
</td>
<td style="text-align:right;">
0.6786
</td>
<td style="text-align:right;">
4533.159
</td>
<td style="text-align:right;">
0.9988
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[8]
</td>
<td style="text-align:right;">
0.2675
</td>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0.0036
</td>
<td style="text-align:right;">
0.2604
</td>
<td style="text-align:right;">
0.2650
</td>
<td style="text-align:right;">
0.2674
</td>
<td style="text-align:right;">
0.2699
</td>
<td style="text-align:right;">
0.2747
</td>
<td style="text-align:right;">
5710.288
</td>
<td style="text-align:right;">
0.9985
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[9]
</td>
<td style="text-align:right;">
0.2685
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0047
</td>
<td style="text-align:right;">
0.2592
</td>
<td style="text-align:right;">
0.2653
</td>
<td style="text-align:right;">
0.2685
</td>
<td style="text-align:right;">
0.2716
</td>
<td style="text-align:right;">
0.2778
</td>
<td style="text-align:right;">
5825.572
</td>
<td style="text-align:right;">
0.9990
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[10]
</td>
<td style="text-align:right;">
0.3783
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0048
</td>
<td style="text-align:right;">
0.3691
</td>
<td style="text-align:right;">
0.3752
</td>
<td style="text-align:right;">
0.3784
</td>
<td style="text-align:right;">
0.3814
</td>
<td style="text-align:right;">
0.3879
</td>
<td style="text-align:right;">
4288.454
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[11]
</td>
<td style="text-align:right;">
0.3315
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0043
</td>
<td style="text-align:right;">
0.3228
</td>
<td style="text-align:right;">
0.3287
</td>
<td style="text-align:right;">
0.3315
</td>
<td style="text-align:right;">
0.3343
</td>
<td style="text-align:right;">
0.3402
</td>
<td style="text-align:right;">
5036.823
</td>
<td style="text-align:right;">
0.9989
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[12]
</td>
<td style="text-align:right;">
0.5876
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0052
</td>
<td style="text-align:right;">
0.5771
</td>
<td style="text-align:right;">
0.5842
</td>
<td style="text-align:right;">
0.5877
</td>
<td style="text-align:right;">
0.5910
</td>
<td style="text-align:right;">
0.5979
</td>
<td style="text-align:right;">
5717.177
</td>
<td style="text-align:right;">
0.9991
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[13]
</td>
<td style="text-align:right;">
0.4050
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0055
</td>
<td style="text-align:right;">
0.3940
</td>
<td style="text-align:right;">
0.4013
</td>
<td style="text-align:right;">
0.4049
</td>
<td style="text-align:right;">
0.4087
</td>
<td style="text-align:right;">
0.4157
</td>
<td style="text-align:right;">
4692.941
</td>
<td style="text-align:right;">
0.9986
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[14]
</td>
<td style="text-align:right;">
0.2770
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0046
</td>
<td style="text-align:right;">
0.2683
</td>
<td style="text-align:right;">
0.2738
</td>
<td style="text-align:right;">
0.2769
</td>
<td style="text-align:right;">
0.2801
</td>
<td style="text-align:right;">
0.2861
</td>
<td style="text-align:right;">
4023.902
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[15]
</td>
<td style="text-align:right;">
0.4479
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0044
</td>
<td style="text-align:right;">
0.4394
</td>
<td style="text-align:right;">
0.4450
</td>
<td style="text-align:right;">
0.4478
</td>
<td style="text-align:right;">
0.4509
</td>
<td style="text-align:right;">
0.4564
</td>
<td style="text-align:right;">
3743.678
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[16]
</td>
<td style="text-align:right;">
0.3672
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0055
</td>
<td style="text-align:right;">
0.3566
</td>
<td style="text-align:right;">
0.3635
</td>
<td style="text-align:right;">
0.3670
</td>
<td style="text-align:right;">
0.3708
</td>
<td style="text-align:right;">
0.3779
</td>
<td style="text-align:right;">
4809.139
</td>
<td style="text-align:right;">
0.9988
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[17]
</td>
<td style="text-align:right;">
0.4040
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0054
</td>
<td style="text-align:right;">
0.3939
</td>
<td style="text-align:right;">
0.4004
</td>
<td style="text-align:right;">
0.4041
</td>
<td style="text-align:right;">
0.4077
</td>
<td style="text-align:right;">
0.4145
</td>
<td style="text-align:right;">
4763.514
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[18]
</td>
<td style="text-align:right;">
0.2446
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0052
</td>
<td style="text-align:right;">
0.2346
</td>
<td style="text-align:right;">
0.2410
</td>
<td style="text-align:right;">
0.2446
</td>
<td style="text-align:right;">
0.2480
</td>
<td style="text-align:right;">
0.2548
</td>
<td style="text-align:right;">
5607.378
</td>
<td style="text-align:right;">
0.9992
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[19]
</td>
<td style="text-align:right;">
0.2313
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0039
</td>
<td style="text-align:right;">
0.2236
</td>
<td style="text-align:right;">
0.2287
</td>
<td style="text-align:right;">
0.2314
</td>
<td style="text-align:right;">
0.2340
</td>
<td style="text-align:right;">
0.2390
</td>
<td style="text-align:right;">
5531.903
</td>
<td style="text-align:right;">
0.9986
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[20]
</td>
<td style="text-align:right;">
0.5233
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0049
</td>
<td style="text-align:right;">
0.5135
</td>
<td style="text-align:right;">
0.5200
</td>
<td style="text-align:right;">
0.5233
</td>
<td style="text-align:right;">
0.5265
</td>
<td style="text-align:right;">
0.5329
</td>
<td style="text-align:right;">
4168.350
</td>
<td style="text-align:right;">
0.9995
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[21]
</td>
<td style="text-align:right;">
0.5652
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0058
</td>
<td style="text-align:right;">
0.5545
</td>
<td style="text-align:right;">
0.5612
</td>
<td style="text-align:right;">
0.5652
</td>
<td style="text-align:right;">
0.5690
</td>
<td style="text-align:right;">
0.5765
</td>
<td style="text-align:right;">
4263.072
</td>
<td style="text-align:right;">
0.9989
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[22]
</td>
<td style="text-align:right;">
0.2521
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0038
</td>
<td style="text-align:right;">
0.2446
</td>
<td style="text-align:right;">
0.2496
</td>
<td style="text-align:right;">
0.2520
</td>
<td style="text-align:right;">
0.2547
</td>
<td style="text-align:right;">
0.2594
</td>
<td style="text-align:right;">
5212.314
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[23]
</td>
<td style="text-align:right;">
0.4440
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0056
</td>
<td style="text-align:right;">
0.4330
</td>
<td style="text-align:right;">
0.4402
</td>
<td style="text-align:right;">
0.4440
</td>
<td style="text-align:right;">
0.4476
</td>
<td style="text-align:right;">
0.4551
</td>
<td style="text-align:right;">
5305.546
</td>
<td style="text-align:right;">
0.9982
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[24]
</td>
<td style="text-align:right;">
0.4034
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0051
</td>
<td style="text-align:right;">
0.3933
</td>
<td style="text-align:right;">
0.3999
</td>
<td style="text-align:right;">
0.4034
</td>
<td style="text-align:right;">
0.4069
</td>
<td style="text-align:right;">
0.4135
</td>
<td style="text-align:right;">
4540.669
</td>
<td style="text-align:right;">
0.9985
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[25]
</td>
<td style="text-align:right;">
0.2333
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0040
</td>
<td style="text-align:right;">
0.2251
</td>
<td style="text-align:right;">
0.2306
</td>
<td style="text-align:right;">
0.2334
</td>
<td style="text-align:right;">
0.2361
</td>
<td style="text-align:right;">
0.2413
</td>
<td style="text-align:right;">
5114.174
</td>
<td style="text-align:right;">
0.9991
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[26]
</td>
<td style="text-align:right;">
0.2601
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0047
</td>
<td style="text-align:right;">
0.2512
</td>
<td style="text-align:right;">
0.2570
</td>
<td style="text-align:right;">
0.2600
</td>
<td style="text-align:right;">
0.2633
</td>
<td style="text-align:right;">
0.2694
</td>
<td style="text-align:right;">
3784.524
</td>
<td style="text-align:right;">
0.9992
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[27]
</td>
<td style="text-align:right;">
0.4380
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0059
</td>
<td style="text-align:right;">
0.4261
</td>
<td style="text-align:right;">
0.4340
</td>
<td style="text-align:right;">
0.4380
</td>
<td style="text-align:right;">
0.4420
</td>
<td style="text-align:right;">
0.4496
</td>
<td style="text-align:right;">
4386.208
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[28]
</td>
<td style="text-align:right;">
0.3535
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0055
</td>
<td style="text-align:right;">
0.3429
</td>
<td style="text-align:right;">
0.3497
</td>
<td style="text-align:right;">
0.3534
</td>
<td style="text-align:right;">
0.3572
</td>
<td style="text-align:right;">
0.3643
</td>
<td style="text-align:right;">
4572.773
</td>
<td style="text-align:right;">
0.9990
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[29]
</td>
<td style="text-align:right;">
0.5310
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0056
</td>
<td style="text-align:right;">
0.5205
</td>
<td style="text-align:right;">
0.5271
</td>
<td style="text-align:right;">
0.5309
</td>
<td style="text-align:right;">
0.5348
</td>
<td style="text-align:right;">
0.5420
</td>
<td style="text-align:right;">
4877.650
</td>
<td style="text-align:right;">
0.9983
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[30]
</td>
<td style="text-align:right;">
0.5259
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0052
</td>
<td style="text-align:right;">
0.5162
</td>
<td style="text-align:right;">
0.5225
</td>
<td style="text-align:right;">
0.5258
</td>
<td style="text-align:right;">
0.5292
</td>
<td style="text-align:right;">
0.5359
</td>
<td style="text-align:right;">
4823.609
</td>
<td style="text-align:right;">
0.9986
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[31]
</td>
<td style="text-align:right;">
0.4547
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0052
</td>
<td style="text-align:right;">
0.4447
</td>
<td style="text-align:right;">
0.4513
</td>
<td style="text-align:right;">
0.4547
</td>
<td style="text-align:right;">
0.4582
</td>
<td style="text-align:right;">
0.4649
</td>
<td style="text-align:right;">
4772.350
</td>
<td style="text-align:right;">
0.9985
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[32]
</td>
<td style="text-align:right;">
0.4037
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0052
</td>
<td style="text-align:right;">
0.3940
</td>
<td style="text-align:right;">
0.4003
</td>
<td style="text-align:right;">
0.4034
</td>
<td style="text-align:right;">
0.4071
</td>
<td style="text-align:right;">
0.4142
</td>
<td style="text-align:right;">
3598.994
</td>
<td style="text-align:right;">
0.9991
</td>
</tr>
</tbody>
</table>
<p>Para validar las cadenas</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="modelos-sintéticos-simples.html#cb33-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mcmc_areas</span>(<span class="fu">as.array</span>(model_Binomial2, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>))</span>
<span id="cb33-2"><a href="modelos-sintéticos-simples.html#cb33-2" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb33-3"><a href="modelos-sintéticos-simples.html#cb33-3" tabindex="-1"></a>       <span class="co"># filename = &quot;Recursos/Día1/Sesion3/0Recursos/Binomial/Binomial1.png&quot;, scale = 2)</span></span>
<span id="cb33-4"><a href="modelos-sintéticos-simples.html#cb33-4" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Binomial/Binomial1.png" width="200%" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="modelos-sintéticos-simples.html#cb34-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mcmc_trace</span>(<span class="fu">as.array</span>(model_Binomial2, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>))</span>
<span id="cb34-2"><a href="modelos-sintéticos-simples.html#cb34-2" tabindex="-1"></a><span class="co"># traceplot(model_Binomial2, pars = &quot;theta&quot;,inc_warmup = TRUE)</span></span>
<span id="cb34-3"><a href="modelos-sintéticos-simples.html#cb34-3" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb34-4"><a href="modelos-sintéticos-simples.html#cb34-4" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Binomial/Binomial2.png&quot;,</span></span>
<span id="cb34-5"><a href="modelos-sintéticos-simples.html#cb34-5" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb34-6"><a href="modelos-sintéticos-simples.html#cb34-6" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Binomial/Binomial2.png" width="400%" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="modelos-sintéticos-simples.html#cb35-1" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Binomial2, <span class="at">pars =</span> <span class="st">&quot;spred&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="modelos-sintéticos-simples.html#cb35-2" tabindex="-1"></a>  <span class="fu">as_draws_matrix</span>()</span>
<span id="cb35-3"><a href="modelos-sintéticos-simples.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="modelos-sintéticos-simples.html#cb35-4" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">200</span>)</span>
<span id="cb35-5"><a href="modelos-sintéticos-simples.html#cb35-5" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb35-6"><a href="modelos-sintéticos-simples.html#cb35-6" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataS, <span class="fu">aes</span>(<span class="at">x =</span> Sd))<span class="sc">+</span></span>
<span id="cb35-7"><a href="modelos-sintéticos-simples.html#cb35-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb35-8"><a href="modelos-sintéticos-simples.html#cb35-8" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-9"><a href="modelos-sintéticos-simples.html#cb35-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-10"><a href="modelos-sintéticos-simples.html#cb35-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">20</span>) </span>
<span id="cb35-11"><a href="modelos-sintéticos-simples.html#cb35-11" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> dataS<span class="sc">$</span>Sd, y_pred2) </span>
<span id="cb35-12"><a href="modelos-sintéticos-simples.html#cb35-12" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> g1<span class="sc">/</span>g2</span>
<span id="cb35-13"><a href="modelos-sintéticos-simples.html#cb35-13" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb35-14"><a href="modelos-sintéticos-simples.html#cb35-14" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Binomial/Binomial3.png&quot;,</span></span>
<span id="cb35-15"><a href="modelos-sintéticos-simples.html#cb35-15" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb35-16"><a href="modelos-sintéticos-simples.html#cb35-16" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Binomial/Binomial3.png" width="200%" /></p>
</div>
</div>
<div id="modelo-de-unidad-normal-con-media-desconocida" class="section level4 hasAnchor" number="3.1.3.3">
<h4><span class="header-section-number">3.1.3.3</span> Modelo de unidad: Normal con media desconocida<a href="modelos-sintéticos-simples.html#modelo-de-unidad-normal-con-media-desconocida" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suponga que <span class="math inline">\(Y_1,\cdots,Y_n\)</span> son variables independientes e idénticamente distribuidos con distribución <span class="math inline">\(Normal(\theta,\sigma^2)\)</span> con <span class="math inline">\(\theta\)</span> desconocido pero <span class="math inline">\(\sigma^2\)</span> conocido. De esta forma, la función de verosimilitud de los datos está dada por</p>
<p><span class="math display">\[
\begin{align*}
p(\mathbf{Y} \mid \theta)
&amp;=\prod_{i=1}^n\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left\{-\frac{1}{2\sigma^2}(y_i-\theta)^2\right\}I_\mathbb{R}(y) \\
&amp;=(2\pi\sigma^2)^{-n/2}\exp\left\{-\frac{1}{2\sigma^2}\sum_{i=1}^n(y_i-\theta)^2\right\}
\end{align*}
\]</span></p>
<p>Como el parámetro <span class="math inline">\(\theta\)</span> puede tomar cualquier valor en los reales, es posible asignarle una distribución previa <span class="math inline">\(\theta \sim Normal(\mu,\tau^2)\)</span>. Bajo este marco de referencia se tienen los siguientes resultados</p>
<p>La distribución posterior del parámetro de interés <span class="math inline">\(\theta\)</span> sigue una distribución</p>
<p><span class="math display">\[
\begin{equation*}
\theta|\mathbf{Y} \sim Normal(\mu_n,\tau^2_n)
\end{equation*}
\]</span></p>
<p>En donde</p>
<p><span class="math display">\[
\begin{equation}
\mu_n=\frac{\frac{n}{\sigma^2}\bar{Y}+\frac{1}{\tau^2}\mu}{\frac{n}{\sigma^2}+\frac{1}{\tau^2}}
\ \ \ \ \ \ \ \text{y} \ \ \ \ \ \ \
\tau_n^2=\left(\frac{n}{\sigma^2}+\frac{1}{\tau^2}\right)^{-1}
\end{equation}
\]</span></p>
<div id="objetivo-2" class="section level5 unnumbered hasAnchor">
<h5>Objetivo<a href="modelos-sintéticos-simples.html#objetivo-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Estimar el ingreso medio de las personas, es decir,
<span class="math display">\[
\bar{Y}_d = \frac{\sum_{U_d}y_{di}}{N_d}
\]</span>
donde <span class="math inline">\(y_{di}\)</span> es el ingreso de cada personas</p>
<p>Note que,</p>
<p><span class="math display">\[
\begin{equation*}
\bar{Y}_d =  \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}y_{di}}{N_d}
\end{equation*}
\]</span></p>
<p>Ahora, el estimador de <span class="math inline">\(\bar{Y}\)</span> esta dado por:</p>
<p><span class="math display">\[
\hat{\bar{Y}}_d = \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}\hat{y}_{di}}{N_d}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[\hat{y}_{di}=E_{\mathscr{M}}\left(y_{di}\mid\boldsymbol{x}_{d},\boldsymbol{\beta}\right)\]</span>,</p>
<p>donde <span class="math inline">\(\mathscr{M}\)</span> hace referencia a la medida de probabilidad inducida por el modelamiento.
De esta forma se tiene que,</p>
<p><span class="math display">\[
\hat{\bar{Y}}_d = \frac{\sum_{U_{d}}\hat{y}_{di}}{N_d}
\]</span></p>
</div>
<div id="práctica-en-stan-2" class="section level5 hasAnchor" number="3.1.3.3.1">
<h5><span class="header-section-number">3.1.3.3.1</span> Práctica en <strong>STAN</strong><a href="modelos-sintéticos-simples.html#práctica-en-stan-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sea <span class="math inline">\(Y\)</span> el logaritmo del ingreso</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="modelos-sintéticos-simples.html#cb36-1" tabindex="-1"></a>dataNormal <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="modelos-sintéticos-simples.html#cb36-2" tabindex="-1"></a>   <span class="fu">filter</span>(dam <span class="sc">==</span> <span class="st">&quot;01&quot;</span>, ingcorte<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="modelos-sintéticos-simples.html#cb36-3" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb36-4"><a href="modelos-sintéticos-simples.html#cb36-4" tabindex="-1"></a>     dam ,</span>
<span id="cb36-5"><a href="modelos-sintéticos-simples.html#cb36-5" tabindex="-1"></a>  <span class="at">logIngreso =</span> <span class="fu">log</span>(ingcorte <span class="sc">+</span><span class="dv">1</span>)) </span>
<span id="cb36-6"><a href="modelos-sintéticos-simples.html#cb36-6" tabindex="-1"></a><span class="co">#3</span></span>
<span id="cb36-7"><a href="modelos-sintéticos-simples.html#cb36-7" tabindex="-1"></a>media <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataNormal<span class="sc">$</span>logIngreso)</span>
<span id="cb36-8"><a href="modelos-sintéticos-simples.html#cb36-8" tabindex="-1"></a>Sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(dataNormal<span class="sc">$</span>logIngreso)</span>
<span id="cb36-9"><a href="modelos-sintéticos-simples.html#cb36-9" tabindex="-1"></a></span>
<span id="cb36-10"><a href="modelos-sintéticos-simples.html#cb36-10" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dataNormal,<span class="fu">aes</span>(<span class="at">x =</span> logIngreso))<span class="sc">+</span> </span>
<span id="cb36-11"><a href="modelos-sintéticos-simples.html#cb36-11" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-12"><a href="modelos-sintéticos-simples.html#cb36-12" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span>dnorm, </span>
<span id="cb36-13"><a href="modelos-sintéticos-simples.html#cb36-13" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> media, <span class="at">sd =</span> Sd),</span>
<span id="cb36-14"><a href="modelos-sintéticos-simples.html#cb36-14" tabindex="-1"></a>                <span class="at">size =</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb36-15"><a href="modelos-sintéticos-simples.html#cb36-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span> </span>
<span id="cb36-16"><a href="modelos-sintéticos-simples.html#cb36-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> (<span class="st">&quot;Log(Ingreso)&quot;</span>))</span>
<span id="cb36-17"><a href="modelos-sintéticos-simples.html#cb36-17" tabindex="-1"></a></span>
<span id="cb36-18"><a href="modelos-sintéticos-simples.html#cb36-18" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dataNormal, <span class="fu">aes</span>(<span class="at">sample =</span> logIngreso)) <span class="sc">+</span></span>
<span id="cb36-19"><a href="modelos-sintéticos-simples.html#cb36-19" tabindex="-1"></a>     <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb36-20"><a href="modelos-sintéticos-simples.html#cb36-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) </span>
<span id="cb36-21"><a href="modelos-sintéticos-simples.html#cb36-21" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> g1<span class="sc">|</span>g2</span>
<span id="cb36-22"><a href="modelos-sintéticos-simples.html#cb36-22" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb36-23"><a href="modelos-sintéticos-simples.html#cb36-23" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal1.png&quot;,</span></span>
<span id="cb36-24"><a href="modelos-sintéticos-simples.html#cb36-24" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb36-25"><a href="modelos-sintéticos-simples.html#cb36-25" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal1.png" width="200%" /></p>
<p>Creando código de <code>STAN</code></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="modelos-sintéticos-simples.html#cb37-1" tabindex="-1"></a>data {</span>
<span id="cb37-2"><a href="modelos-sintéticos-simples.html#cb37-2" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;     <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb37-3"><a href="modelos-sintéticos-simples.html#cb37-3" tabindex="-1"></a>  real y[n];          <span class="sc">/</span><span class="er">/</span> LogIngreso </span>
<span id="cb37-4"><a href="modelos-sintéticos-simples.html#cb37-4" tabindex="-1"></a>  real <span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> Sigma;  <span class="sc">/</span><span class="er">/</span> Desviación estándar   </span>
<span id="cb37-5"><a href="modelos-sintéticos-simples.html#cb37-5" tabindex="-1"></a>}</span>
<span id="cb37-6"><a href="modelos-sintéticos-simples.html#cb37-6" tabindex="-1"></a>parameters {</span>
<span id="cb37-7"><a href="modelos-sintéticos-simples.html#cb37-7" tabindex="-1"></a>  real theta;</span>
<span id="cb37-8"><a href="modelos-sintéticos-simples.html#cb37-8" tabindex="-1"></a>}</span>
<span id="cb37-9"><a href="modelos-sintéticos-simples.html#cb37-9" tabindex="-1"></a>model {</span>
<span id="cb37-10"><a href="modelos-sintéticos-simples.html#cb37-10" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">normal</span>(theta, Sigma);</span>
<span id="cb37-11"><a href="modelos-sintéticos-simples.html#cb37-11" tabindex="-1"></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>); <span class="sc">/</span><span class="er">/</span> Distribución previa</span>
<span id="cb37-12"><a href="modelos-sintéticos-simples.html#cb37-12" tabindex="-1"></a>}</span>
<span id="cb37-13"><a href="modelos-sintéticos-simples.html#cb37-13" tabindex="-1"></a>generated quantities {</span>
<span id="cb37-14"><a href="modelos-sintéticos-simples.html#cb37-14" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> Vector de longitud n</span>
<span id="cb37-15"><a href="modelos-sintéticos-simples.html#cb37-15" tabindex="-1"></a>    <span class="cf">for</span>(kk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb37-16"><a href="modelos-sintéticos-simples.html#cb37-16" tabindex="-1"></a>    ypred[kk] <span class="ot">=</span> <span class="fu">normal_rng</span>(theta,Sigma);</span>
<span id="cb37-17"><a href="modelos-sintéticos-simples.html#cb37-17" tabindex="-1"></a>}</span>
<span id="cb37-18"><a href="modelos-sintéticos-simples.html#cb37-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Preparando el código de <code>STAN</code></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="modelos-sintéticos-simples.html#cb38-1" tabindex="-1"></a>NormalMedia <span class="ot">&lt;-</span> <span class="st">&quot;Recursos/Día1/Sesion3/Data/modelosStan/4NormalMedia.stan&quot;</span> </span></code></pre></div>
<p>Organizando datos para <code>STAN</code></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="modelos-sintéticos-simples.html#cb39-1" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(dataNormal),</span>
<span id="cb39-2"><a href="modelos-sintéticos-simples.html#cb39-2" tabindex="-1"></a>                    <span class="at">Sigma =</span> <span class="fu">sd</span>(dataNormal<span class="sc">$</span>logIngreso),</span>
<span id="cb39-3"><a href="modelos-sintéticos-simples.html#cb39-3" tabindex="-1"></a>                    <span class="at">y =</span> dataNormal<span class="sc">$</span>logIngreso)</span></code></pre></div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>rstan</em></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="modelos-sintéticos-simples.html#cb40-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb40-2"><a href="modelos-sintéticos-simples.html#cb40-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>) <span class="co"># speed up running time </span></span>
<span id="cb40-3"><a href="modelos-sintéticos-simples.html#cb40-3" tabindex="-1"></a>model_NormalMedia <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb40-4"><a href="modelos-sintéticos-simples.html#cb40-4" tabindex="-1"></a>  <span class="at">file =</span> NormalMedia,  </span>
<span id="cb40-5"><a href="modelos-sintéticos-simples.html#cb40-5" tabindex="-1"></a>  <span class="at">data =</span> sample_data,   </span>
<span id="cb40-6"><a href="modelos-sintéticos-simples.html#cb40-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-7"><a href="modelos-sintéticos-simples.html#cb40-7" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">500</span>,         </span>
<span id="cb40-8"><a href="modelos-sintéticos-simples.html#cb40-8" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">1000</span>,            </span>
<span id="cb40-9"><a href="modelos-sintéticos-simples.html#cb40-9" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>              </span>
<span id="cb40-10"><a href="modelos-sintéticos-simples.html#cb40-10" tabindex="-1"></a>)</span>
<span id="cb40-11"><a href="modelos-sintéticos-simples.html#cb40-11" tabindex="-1"></a><span class="fu">saveRDS</span>(model_NormalMedia, <span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Normal/model_NormalMedia.rds&quot;</span>)</span>
<span id="cb40-12"><a href="modelos-sintéticos-simples.html#cb40-12" tabindex="-1"></a>model_NormalMedia <span class="ot">&lt;-</span> </span>
<span id="cb40-13"><a href="modelos-sintéticos-simples.html#cb40-13" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Normal/model_NormalMedia.rds&quot;</span>)</span></code></pre></div>
<p>La estimación del parámetro <span class="math inline">\(\theta\)</span> es:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="modelos-sintéticos-simples.html#cb41-1" tabindex="-1"></a>tabla_Nor1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)<span class="sc">$</span>summary</span>
<span id="cb41-2"><a href="modelos-sintéticos-simples.html#cb41-2" tabindex="-1"></a>tabla_Nor1 <span class="sc">%&gt;%</span> <span class="fu">tba</span>()  </span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
theta
</td>
<td style="text-align:right;">
8.2466
</td>
<td style="text-align:right;">
3e-04
</td>
<td style="text-align:right;">
0.0073
</td>
<td style="text-align:right;">
8.2323
</td>
<td style="text-align:right;">
8.2417
</td>
<td style="text-align:right;">
8.2465
</td>
<td style="text-align:right;">
8.2515
</td>
<td style="text-align:right;">
8.2605
</td>
<td style="text-align:right;">
705.1854
</td>
<td style="text-align:right;">
1.0025
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="modelos-sintéticos-simples.html#cb42-1" tabindex="-1"></a>posterior_theta <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)</span>
<span id="cb42-2"><a href="modelos-sintéticos-simples.html#cb42-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_theta) <span class="sc">+</span></span>
<span id="cb42-3"><a href="modelos-sintéticos-simples.html#cb42-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_theta) ) <span class="sc">/</span> </span>
<span id="cb42-4"><a href="modelos-sintéticos-simples.html#cb42-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_theta)</span>
<span id="cb42-5"><a href="modelos-sintéticos-simples.html#cb42-5" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb42-6"><a href="modelos-sintéticos-simples.html#cb42-6" tabindex="-1"></a><span class="co">#        filename =&quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal2.png&quot;,</span></span>
<span id="cb42-7"><a href="modelos-sintéticos-simples.html#cb42-7" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb42-8"><a href="modelos-sintéticos-simples.html#cb42-8" tabindex="-1"></a></span>
<span id="cb42-9"><a href="modelos-sintéticos-simples.html#cb42-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal2.png" width="200%" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="modelos-sintéticos-simples.html#cb43-1" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;ypred&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="modelos-sintéticos-simples.html#cb43-2" tabindex="-1"></a>  <span class="fu">as_draws_matrix</span>()</span>
<span id="cb43-3"><a href="modelos-sintéticos-simples.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="modelos-sintéticos-simples.html#cb43-4" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb43-5"><a href="modelos-sintéticos-simples.html#cb43-5" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb43-6"><a href="modelos-sintéticos-simples.html#cb43-6" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(dataNormal<span class="sc">$</span>logIngreso), y_pred2)<span class="sc">/</span></span>
<span id="cb43-7"><a href="modelos-sintéticos-simples.html#cb43-7" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">exp</span>(<span class="fu">as.numeric</span>(dataNormal<span class="sc">$</span>logIngreso))<span class="sc">-</span><span class="dv">1</span>, <span class="fu">exp</span>(y_pred2)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">20000</span>)</span>
<span id="cb43-8"><a href="modelos-sintéticos-simples.html#cb43-8" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> p1,</span>
<span id="cb43-9"><a href="modelos-sintéticos-simples.html#cb43-9" tabindex="-1"></a>       <span class="at">filename =</span><span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal3.png&quot;</span>,</span>
<span id="cb43-10"><a href="modelos-sintéticos-simples.html#cb43-10" tabindex="-1"></a>       <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb43-11"><a href="modelos-sintéticos-simples.html#cb43-11" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal3.png" width="200%" /></p>
</div>
</div>
</div>
<div id="modelos-multiparamétricos" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Modelos multiparamétricos<a href="modelos-sintéticos-simples.html#modelos-multiparamétricos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>La distribución normal univariada que tiene dos parámetros: la media <span class="math inline">\(\theta\)</span> y la varianza <span class="math inline">\(\sigma^2\)</span>.</li>
<li>La distribución multinomial cuyo parámetro es un vector de probabilidades <span class="math inline">\(\boldsymbol{\theta}\)</span>.</li>
</ul>
<div id="modelo-de-unidad-normal-con-media-y-varianza-desconocida" class="section level4 hasAnchor" number="3.1.4.1">
<h4><span class="header-section-number">3.1.4.1</span> Modelo de unidad: Normal con media y varianza desconocida<a href="modelos-sintéticos-simples.html#modelo-de-unidad-normal-con-media-y-varianza-desconocida" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Supongamos que se dispone de realizaciones de un conjunto de variables independientes e idénticamente distribuidas <span class="math inline">\(Y_1,\cdots,Y_n\sim N(\theta,\sigma^2)\)</span>. Cuando se desconoce tanto la media como la varianza de la distribución es necesario plantear diversos enfoques y situarse en el más conveniente, según el contexto del problema. En términos de la asignación de las distribuciones previas para <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span> es posible:</p>
<ul>
<li>Suponer que la distribución previa <span class="math inline">\(p(\theta)\)</span> es independiente de la distribución previa <span class="math inline">\(p(\sigma^2)\)</span> y que ambas distribuciones son informativas.</li>
<li>Suponer que la distribución previa <span class="math inline">\(p(\theta)\)</span> es independiente de la distribución previa <span class="math inline">\(p(\sigma^2)\)</span> y que ambas distribuciones son no informativas.</li>
<li>Suponer que la distribución previa para <span class="math inline">\(\theta\)</span> depende de <span class="math inline">\(\sigma^2\)</span> y escribirla como <span class="math inline">\(p(\theta \mid \sigma^2)\)</span>, mientras que la distribución previa de <span class="math inline">\(\sigma^2\)</span> no depende de <span class="math inline">\(\theta\)</span> y se puede escribir como <span class="math inline">\(p(\sigma^2)\)</span>.</li>
</ul>
<p>La distribución previa para el parámetro <span class="math inline">\(\theta\)</span> será</p>
<p><span class="math display">\[
\begin{equation*}
\theta \sim Normal(0,10000)
\end{equation*}
\]</span></p>
<p>Y la distribución previa para el parámetro <span class="math inline">\(\sigma^2\)</span> será</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \sim IG(0.0001,0.0001)
\end{equation*}
\]</span></p>
<p>La distribución posterior condicional de <span class="math inline">\(\theta\)</span> es</p>
<p><span class="math display">\[
\begin{equation}
\theta  \mid  \sigma^2,\mathbf{Y} \sim Normal(\mu_n,\tau_n^2)
\end{equation}
\]</span></p>
<p>En donde las expresiones para <span class="math inline">\(\mu_n\)</span> y <span class="math inline">\(\tau_n^2\)</span> están dados previamente.</p>
<p>En el siguiente enlace enconará el libro: <a href="https://psirusteam.github.io/bookdownBayesiano/">Modelos Bayesianos con R y STAN</a> donde puede profundizar en el desarrollo matemático de los resultados anteriores.</p>
<div id="objetivo-3" class="section level5 unnumbered hasAnchor">
<h5>Objetivo<a href="modelos-sintéticos-simples.html#objetivo-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Estimar el ingreso medio de las personas, es decir,
<span class="math display">\[
\bar{Y}_d = \frac{\sum_{U_d}y_{di}}{N_d}
\]</span>
donde <span class="math inline">\(y_{di}\)</span> es el ingreso de cada personas</p>
<p>Note que,</p>
<p><span class="math display">\[
\begin{equation*}
\bar{Y}_d =  \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}y_{di}}{N_d}
\end{equation*}
\]</span></p>
<p>Ahora, el estimador de <span class="math inline">\(\bar{Y}\)</span> esta dado por:</p>
<p><span class="math display">\[
\hat{\bar{Y}}_d = \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}\hat{y}_{di}}{N_d}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[\hat{y}_{di}=E_{\mathscr{M}}\left(y_{di}\mid\boldsymbol{x}_{d},\boldsymbol{\beta}\right)\]</span>,</p>
<p>donde <span class="math inline">\(\mathscr{M}\)</span> hace referencia a la medida de probabilidad inducida por el modelamiento.
De esta forma se tiene que,</p>
<p><span class="math display">\[
\hat{\bar{Y}}_d = \frac{\sum_{U_{d}}\hat{y}_{di}}{N_d}
\]</span></p>
</div>
<div id="práctica-en-stan-3" class="section level5 hasAnchor" number="3.1.4.1.1">
<h5><span class="header-section-number">3.1.4.1.1</span> Práctica en <strong>STAN</strong><a href="modelos-sintéticos-simples.html#práctica-en-stan-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sea <span class="math inline">\(Y\)</span> el logaritmo del ingreso</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="modelos-sintéticos-simples.html#cb44-1" tabindex="-1"></a>dataNormal <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="modelos-sintéticos-simples.html#cb44-2" tabindex="-1"></a>  <span class="fu">filter</span>(dam <span class="sc">==</span> <span class="st">&quot;01&quot;</span>, ingcorte<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="modelos-sintéticos-simples.html#cb44-3" tabindex="-1"></a>    <span class="fu">transmute</span>(dam,</span>
<span id="cb44-4"><a href="modelos-sintéticos-simples.html#cb44-4" tabindex="-1"></a>      <span class="at">logIngreso =</span> <span class="fu">log</span>(ingcorte <span class="sc">+</span><span class="dv">1</span>)) </span></code></pre></div>
<p>Creando código de <code>STAN</code></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="modelos-sintéticos-simples.html#cb45-1" tabindex="-1"></a>data {</span>
<span id="cb45-2"><a href="modelos-sintéticos-simples.html#cb45-2" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;</span>
<span id="cb45-3"><a href="modelos-sintéticos-simples.html#cb45-3" tabindex="-1"></a>  real y[n];</span>
<span id="cb45-4"><a href="modelos-sintéticos-simples.html#cb45-4" tabindex="-1"></a>}</span>
<span id="cb45-5"><a href="modelos-sintéticos-simples.html#cb45-5" tabindex="-1"></a>parameters {</span>
<span id="cb45-6"><a href="modelos-sintéticos-simples.html#cb45-6" tabindex="-1"></a>  real sigma;</span>
<span id="cb45-7"><a href="modelos-sintéticos-simples.html#cb45-7" tabindex="-1"></a>  real theta;</span>
<span id="cb45-8"><a href="modelos-sintéticos-simples.html#cb45-8" tabindex="-1"></a>}</span>
<span id="cb45-9"><a href="modelos-sintéticos-simples.html#cb45-9" tabindex="-1"></a>transformed parameters {</span>
<span id="cb45-10"><a href="modelos-sintéticos-simples.html#cb45-10" tabindex="-1"></a>  real sigma2;</span>
<span id="cb45-11"><a href="modelos-sintéticos-simples.html#cb45-11" tabindex="-1"></a>  sigma2 <span class="ot">=</span> <span class="fu">pow</span>(sigma, <span class="dv">2</span>);</span>
<span id="cb45-12"><a href="modelos-sintéticos-simples.html#cb45-12" tabindex="-1"></a>}</span>
<span id="cb45-13"><a href="modelos-sintéticos-simples.html#cb45-13" tabindex="-1"></a>model {</span>
<span id="cb45-14"><a href="modelos-sintéticos-simples.html#cb45-14" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">normal</span>(theta, sigma);</span>
<span id="cb45-15"><a href="modelos-sintéticos-simples.html#cb45-15" tabindex="-1"></a>  theta <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>);</span>
<span id="cb45-16"><a href="modelos-sintéticos-simples.html#cb45-16" tabindex="-1"></a>  sigma2 <span class="sc">~</span> <span class="fu">inv_gamma</span>(<span class="fl">0.001</span>, <span class="fl">0.001</span>);</span>
<span id="cb45-17"><a href="modelos-sintéticos-simples.html#cb45-17" tabindex="-1"></a>}</span>
<span id="cb45-18"><a href="modelos-sintéticos-simples.html#cb45-18" tabindex="-1"></a>generated quantities {</span>
<span id="cb45-19"><a href="modelos-sintéticos-simples.html#cb45-19" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb45-20"><a href="modelos-sintéticos-simples.html#cb45-20" tabindex="-1"></a>    <span class="cf">for</span>(kk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb45-21"><a href="modelos-sintéticos-simples.html#cb45-21" tabindex="-1"></a>    ypred[kk] <span class="ot">=</span> <span class="fu">normal_rng</span>(theta,sigma);</span>
<span id="cb45-22"><a href="modelos-sintéticos-simples.html#cb45-22" tabindex="-1"></a>}</span>
<span id="cb45-23"><a href="modelos-sintéticos-simples.html#cb45-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Preparando el código de <code>STAN</code></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="modelos-sintéticos-simples.html#cb46-1" tabindex="-1"></a>NormalMeanVar  <span class="ot">&lt;-</span> <span class="st">&quot;Recursos/Día1/Sesion3/Data/modelosStan/5NormalMeanVar.stan&quot;</span> </span></code></pre></div>
<p>Organizando datos para <code>STAN</code></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="modelos-sintéticos-simples.html#cb47-1" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(dataNormal),</span>
<span id="cb47-2"><a href="modelos-sintéticos-simples.html#cb47-2" tabindex="-1"></a>                    <span class="at">y =</span> dataNormal<span class="sc">$</span>logIngreso)</span></code></pre></div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>rstan</em></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="modelos-sintéticos-simples.html#cb48-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb48-2"><a href="modelos-sintéticos-simples.html#cb48-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>) <span class="co"># speed up running time </span></span>
<span id="cb48-3"><a href="modelos-sintéticos-simples.html#cb48-3" tabindex="-1"></a></span>
<span id="cb48-4"><a href="modelos-sintéticos-simples.html#cb48-4" tabindex="-1"></a>model_NormalMedia <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb48-5"><a href="modelos-sintéticos-simples.html#cb48-5" tabindex="-1"></a>  <span class="at">file =</span> NormalMeanVar,  </span>
<span id="cb48-6"><a href="modelos-sintéticos-simples.html#cb48-6" tabindex="-1"></a>  <span class="at">data =</span> sample_data,   </span>
<span id="cb48-7"><a href="modelos-sintéticos-simples.html#cb48-7" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-8"><a href="modelos-sintéticos-simples.html#cb48-8" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">500</span>,         </span>
<span id="cb48-9"><a href="modelos-sintéticos-simples.html#cb48-9" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">1000</span>,            </span>
<span id="cb48-10"><a href="modelos-sintéticos-simples.html#cb48-10" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>              </span>
<span id="cb48-11"><a href="modelos-sintéticos-simples.html#cb48-11" tabindex="-1"></a>)</span>
<span id="cb48-12"><a href="modelos-sintéticos-simples.html#cb48-12" tabindex="-1"></a></span>
<span id="cb48-13"><a href="modelos-sintéticos-simples.html#cb48-13" tabindex="-1"></a><span class="fu">saveRDS</span>(model_NormalMedia,<span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Normal/model_NormalMedia2.rds&quot;</span>)</span>
<span id="cb48-14"><a href="modelos-sintéticos-simples.html#cb48-14" tabindex="-1"></a>model_NormalMedia <span class="ot">&lt;-</span> </span>
<span id="cb48-15"><a href="modelos-sintéticos-simples.html#cb48-15" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Normal/model_NormalMedia2.rds&quot;</span>)</span></code></pre></div>
<p>La estimación del parámetro <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span> es:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="modelos-sintéticos-simples.html#cb49-1" tabindex="-1"></a>tabla_Nor2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_NormalMedia, </span>
<span id="cb49-2"><a href="modelos-sintéticos-simples.html#cb49-2" tabindex="-1"></a>        <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;sigma2&quot;</span>, <span class="st">&quot;sigma&quot;</span>))<span class="sc">$</span>summary</span>
<span id="cb49-3"><a href="modelos-sintéticos-simples.html#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="modelos-sintéticos-simples.html#cb49-4" tabindex="-1"></a>tabla_Nor2 <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
theta
</td>
<td style="text-align:right;">
8.2467
</td>
<td style="text-align:right;">
2e-04
</td>
<td style="text-align:right;">
0.0073
</td>
<td style="text-align:right;">
8.2325
</td>
<td style="text-align:right;">
8.2418
</td>
<td style="text-align:right;">
8.2467
</td>
<td style="text-align:right;">
8.2515
</td>
<td style="text-align:right;">
8.2611
</td>
<td style="text-align:right;">
1145.486
</td>
<td style="text-align:right;">
1.0005
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma2
</td>
<td style="text-align:right;">
0.5225
</td>
<td style="text-align:right;">
2e-04
</td>
<td style="text-align:right;">
0.0072
</td>
<td style="text-align:right;">
0.5086
</td>
<td style="text-align:right;">
0.5176
</td>
<td style="text-align:right;">
0.5223
</td>
<td style="text-align:right;">
0.5276
</td>
<td style="text-align:right;">
0.5368
</td>
<td style="text-align:right;">
2093.372
</td>
<td style="text-align:right;">
0.9990
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
0.7228
</td>
<td style="text-align:right;">
1e-04
</td>
<td style="text-align:right;">
0.0050
</td>
<td style="text-align:right;">
0.7132
</td>
<td style="text-align:right;">
0.7194
</td>
<td style="text-align:right;">
0.7227
</td>
<td style="text-align:right;">
0.7264
</td>
<td style="text-align:right;">
0.7327
</td>
<td style="text-align:right;">
2093.723
</td>
<td style="text-align:right;">
0.9989
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="modelos-sintéticos-simples.html#cb50-1" tabindex="-1"></a>posterior_theta <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;theta&quot;</span>)</span>
<span id="cb50-2"><a href="modelos-sintéticos-simples.html#cb50-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_theta) <span class="sc">+</span></span>
<span id="cb50-3"><a href="modelos-sintéticos-simples.html#cb50-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_theta) ) <span class="sc">/</span> </span>
<span id="cb50-4"><a href="modelos-sintéticos-simples.html#cb50-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_theta)</span>
<span id="cb50-5"><a href="modelos-sintéticos-simples.html#cb50-5" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb50-6"><a href="modelos-sintéticos-simples.html#cb50-6" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal4.png&quot;,</span></span>
<span id="cb50-7"><a href="modelos-sintéticos-simples.html#cb50-7" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb50-8"><a href="modelos-sintéticos-simples.html#cb50-8" tabindex="-1"></a>p1 </span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal4.png" width="200%" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="modelos-sintéticos-simples.html#cb51-1" tabindex="-1"></a>posterior_sigma2 <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;sigma2&quot;</span>)</span>
<span id="cb51-2"><a href="modelos-sintéticos-simples.html#cb51-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_sigma2) <span class="sc">+</span></span>
<span id="cb51-3"><a href="modelos-sintéticos-simples.html#cb51-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_sigma2) ) <span class="sc">/</span> </span>
<span id="cb51-4"><a href="modelos-sintéticos-simples.html#cb51-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_sigma2)</span>
<span id="cb51-5"><a href="modelos-sintéticos-simples.html#cb51-5" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb51-6"><a href="modelos-sintéticos-simples.html#cb51-6" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal5.png&quot;,</span></span>
<span id="cb51-7"><a href="modelos-sintéticos-simples.html#cb51-7" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb51-8"><a href="modelos-sintéticos-simples.html#cb51-8" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal5.png" width="200%" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="modelos-sintéticos-simples.html#cb52-1" tabindex="-1"></a>posterior_sigma <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb52-2"><a href="modelos-sintéticos-simples.html#cb52-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_sigma) <span class="sc">+</span></span>
<span id="cb52-3"><a href="modelos-sintéticos-simples.html#cb52-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_sigma) ) <span class="sc">/</span> </span>
<span id="cb52-4"><a href="modelos-sintéticos-simples.html#cb52-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_sigma)</span>
<span id="cb52-5"><a href="modelos-sintéticos-simples.html#cb52-5" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb52-6"><a href="modelos-sintéticos-simples.html#cb52-6" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal6.png&quot;,</span></span>
<span id="cb52-7"><a href="modelos-sintéticos-simples.html#cb52-7" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb52-8"><a href="modelos-sintéticos-simples.html#cb52-8" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal6.png" width="200%" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="modelos-sintéticos-simples.html#cb53-1" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_NormalMedia, <span class="at">pars =</span> <span class="st">&quot;ypred&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="modelos-sintéticos-simples.html#cb53-2" tabindex="-1"></a>  <span class="fu">as_draws_matrix</span>()</span>
<span id="cb53-3"><a href="modelos-sintéticos-simples.html#cb53-3" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb53-4"><a href="modelos-sintéticos-simples.html#cb53-4" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb53-5"><a href="modelos-sintéticos-simples.html#cb53-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(<span class="fu">exp</span>(dataNormal<span class="sc">$</span>logIngreso)<span class="sc">-</span><span class="dv">1</span>), y_pred2) <span class="sc">+</span>   <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">20000</span>)</span>
<span id="cb53-6"><a href="modelos-sintéticos-simples.html#cb53-6" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb53-7"><a href="modelos-sintéticos-simples.html#cb53-7" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Normal/Normal7.png&quot;,</span></span>
<span id="cb53-8"><a href="modelos-sintéticos-simples.html#cb53-8" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb53-9"><a href="modelos-sintéticos-simples.html#cb53-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Normal/Normal7.png" width="200%" /></p>
</div>
</div>
<div id="modelo-de-área-multinomial" class="section level4 hasAnchor" number="3.1.4.2">
<h4><span class="header-section-number">3.1.4.2</span> Modelo de área: Multinomial<a href="modelos-sintéticos-simples.html#modelo-de-área-multinomial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En esta sección discutimos el modelamiento bayesiano de datos provenientes de una distribución multinomial que corresponde a una extensión multivariada de la distribución binomial. Suponga que <span class="math inline">\(\textbf{Y}=(Y_1,\ldots,Y_K)^{T}\)</span> es un vector aleatorio con distribución multinomial, así, su distribución está parametrizada por el vector <span class="math inline">\(\boldsymbol{\theta}=(\theta_1,\ldots,\theta_K)^{T}\)</span> y está dada por la siguiente expresión</p>
<p><span class="math display">\[
\begin{equation}
p(\mathbf{Y} \mid \boldsymbol{\theta})=\binom{n}{y_1,\ldots,y_K}\prod_{k=1}^K\theta_k^{y_k} \ \ \ \ \ \theta_k&gt;0 \texttt{ , }  \sum_{k=1}^{K}y_k=n \texttt{ y } \sum_{k=1}^K\theta_k=1
\end{equation}
\]</span> Donde</p>
<p><span class="math display">\[
\begin{equation*}
\binom{n}{y_1,\ldots,y_K}=\frac{n!}{y_1!\cdots y_K!}.
\end{equation*}
\]</span></p>
<p>Como cada parámetro <span class="math inline">\(\theta_k\)</span> está restringido al espacio <span class="math inline">\(\Theta=[0,1]\)</span>, entonces es posible asignar a la distribución de Dirichlet como la distribución previa del vector de parámetros. Por lo tanto la distribución previa del vector de parámetros <span class="math inline">\(\boldsymbol{\theta}\)</span>, parametrizada por el vector de hiperparámetros <span class="math inline">\(\boldsymbol{\alpha}=(\alpha_1,\ldots,\alpha_K)^{T}\)</span>, está dada por</p>
<p><span class="math display">\[
\begin{equation}
p(\boldsymbol{\theta} \mid \boldsymbol{\alpha})=\frac{\Gamma(\alpha_1+\cdots+\alpha_K)}{\Gamma(\alpha_1)\cdots\Gamma(\alpha_K)}
  \prod_{k=1}^K\theta_k^{\alpha_k-1} \ \ \ \ \ \alpha_k&gt;0 \texttt{ y } \sum_{k=1}^K\theta_k=1
\end{equation}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\boldsymbol{\theta}\)</span> sigue una distribución <span class="math inline">\(Dirichlet(y_1+\alpha_1,\ldots,y_K+\alpha_K)\)</span></p>
<div id="práctica-en-stan-4" class="section level5 hasAnchor" number="3.1.4.2.1">
<h5><span class="header-section-number">3.1.4.2.1</span> Práctica en <strong>STAN</strong><a href="modelos-sintéticos-simples.html#práctica-en-stan-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sea <span class="math inline">\(Y\)</span> condición de actividad laboral</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="modelos-sintéticos-simples.html#cb54-1" tabindex="-1"></a>dataMult <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condact3 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="modelos-sintéticos-simples.html#cb54-2" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb54-3"><a href="modelos-sintéticos-simples.html#cb54-3" tabindex="-1"></a>   <span class="at">empleo =</span> <span class="fu">as_factor</span>(condact3)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="modelos-sintéticos-simples.html#cb54-4" tabindex="-1"></a>  <span class="fu">group_by</span>(empleo) <span class="sc">%&gt;%</span>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="modelos-sintéticos-simples.html#cb54-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">theta =</span> n<span class="sc">/</span><span class="fu">sum</span>(n))</span>
<span id="cb54-6"><a href="modelos-sintéticos-simples.html#cb54-6" tabindex="-1"></a><span class="fu">tba</span>(dataMult)</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
empleo
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
theta
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Ocupado
</td>
<td style="text-align:right;">
149387
</td>
<td style="text-align:right;">
0.5876
</td>
</tr>
<tr>
<td style="text-align:left;">
Desocupado
</td>
<td style="text-align:right;">
6969
</td>
<td style="text-align:right;">
0.0274
</td>
</tr>
<tr>
<td style="text-align:left;">
Inactivo
</td>
<td style="text-align:right;">
97867
</td>
<td style="text-align:right;">
0.3850
</td>
</tr>
</tbody>
</table>
<p>donde <em>1</em> corresponde a <strong>Ocupado</strong>, <em>2</em> son los <strong>Desocupado</strong> y <em>3</em> son <strong>Inactivo</strong></p>
<p>Creando código de <code>STAN</code></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="modelos-sintéticos-simples.html#cb55-1" tabindex="-1"></a>data {</span>
<span id="cb55-2"><a href="modelos-sintéticos-simples.html#cb55-2" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> k;  <span class="sc">/</span><span class="er">/</span> Número de cátegoria </span>
<span id="cb55-3"><a href="modelos-sintéticos-simples.html#cb55-3" tabindex="-1"></a>  int y[k];        <span class="sc">/</span><span class="er">/</span> Número de exitos </span>
<span id="cb55-4"><a href="modelos-sintéticos-simples.html#cb55-4" tabindex="-1"></a>  vector[k] alpha; <span class="sc">/</span><span class="er">/</span> Parámetro de las distribción previa </span>
<span id="cb55-5"><a href="modelos-sintéticos-simples.html#cb55-5" tabindex="-1"></a>}</span>
<span id="cb55-6"><a href="modelos-sintéticos-simples.html#cb55-6" tabindex="-1"></a>parameters {</span>
<span id="cb55-7"><a href="modelos-sintéticos-simples.html#cb55-7" tabindex="-1"></a>  simplex[k] theta;</span>
<span id="cb55-8"><a href="modelos-sintéticos-simples.html#cb55-8" tabindex="-1"></a>}</span>
<span id="cb55-9"><a href="modelos-sintéticos-simples.html#cb55-9" tabindex="-1"></a>transformed parameters {</span>
<span id="cb55-10"><a href="modelos-sintéticos-simples.html#cb55-10" tabindex="-1"></a>  real delta;                              <span class="sc">/</span><span class="er">/</span> Tasa de desocupación</span>
<span id="cb55-11"><a href="modelos-sintéticos-simples.html#cb55-11" tabindex="-1"></a>  delta <span class="ot">=</span> theta[<span class="dv">2</span>]<span class="sc">/</span> (theta[<span class="dv">2</span>] <span class="sc">+</span> theta[<span class="dv">1</span>]); <span class="sc">/</span><span class="er">/</span> (Desocupado)<span class="sc">/</span>(Desocupado <span class="sc">+</span> Ocupado)</span>
<span id="cb55-12"><a href="modelos-sintéticos-simples.html#cb55-12" tabindex="-1"></a>}</span>
<span id="cb55-13"><a href="modelos-sintéticos-simples.html#cb55-13" tabindex="-1"></a>model {</span>
<span id="cb55-14"><a href="modelos-sintéticos-simples.html#cb55-14" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">multinomial</span>(theta);</span>
<span id="cb55-15"><a href="modelos-sintéticos-simples.html#cb55-15" tabindex="-1"></a>  theta <span class="sc">~</span> <span class="fu">dirichlet</span>(alpha);</span>
<span id="cb55-16"><a href="modelos-sintéticos-simples.html#cb55-16" tabindex="-1"></a>}</span>
<span id="cb55-17"><a href="modelos-sintéticos-simples.html#cb55-17" tabindex="-1"></a>generated quantities {</span>
<span id="cb55-18"><a href="modelos-sintéticos-simples.html#cb55-18" tabindex="-1"></a>  int ypred[k];</span>
<span id="cb55-19"><a href="modelos-sintéticos-simples.html#cb55-19" tabindex="-1"></a>  ypred <span class="ot">=</span> <span class="fu">multinomial_rng</span>(theta, <span class="fu">sum</span>(y));</span>
<span id="cb55-20"><a href="modelos-sintéticos-simples.html#cb55-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Preparando el código de <code>STAN</code></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="modelos-sintéticos-simples.html#cb56-1" tabindex="-1"></a>Multinom  <span class="ot">&lt;-</span> <span class="st">&quot;Recursos/Día1/Sesion3/Data/modelosStan/6Multinom.stan&quot;</span> </span></code></pre></div>
<p>Organizando datos para <code>STAN</code></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="modelos-sintéticos-simples.html#cb57-1" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">k =</span> <span class="fu">nrow</span>(dataMult),</span>
<span id="cb57-2"><a href="modelos-sintéticos-simples.html#cb57-2" tabindex="-1"></a>                    <span class="at">y =</span> dataMult<span class="sc">$</span>n,</span>
<span id="cb57-3"><a href="modelos-sintéticos-simples.html#cb57-3" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>rstan</em></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="modelos-sintéticos-simples.html#cb58-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb58-2"><a href="modelos-sintéticos-simples.html#cb58-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>) <span class="co"># speed up running time </span></span>
<span id="cb58-3"><a href="modelos-sintéticos-simples.html#cb58-3" tabindex="-1"></a>model_Multinom <span class="ot">&lt;-</span> <span class="fu">stan</span>(</span>
<span id="cb58-4"><a href="modelos-sintéticos-simples.html#cb58-4" tabindex="-1"></a>  <span class="at">file =</span> Multinom,  </span>
<span id="cb58-5"><a href="modelos-sintéticos-simples.html#cb58-5" tabindex="-1"></a>  <span class="at">data =</span> sample_data,   </span>
<span id="cb58-6"><a href="modelos-sintéticos-simples.html#cb58-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-7"><a href="modelos-sintéticos-simples.html#cb58-7" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">500</span>,         </span>
<span id="cb58-8"><a href="modelos-sintéticos-simples.html#cb58-8" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">1000</span>,            </span>
<span id="cb58-9"><a href="modelos-sintéticos-simples.html#cb58-9" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>              </span>
<span id="cb58-10"><a href="modelos-sintéticos-simples.html#cb58-10" tabindex="-1"></a>)</span>
<span id="cb58-11"><a href="modelos-sintéticos-simples.html#cb58-11" tabindex="-1"></a><span class="fu">saveRDS</span>(model_Multinom, <span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/model_Multinom.rds&quot;</span>)</span>
<span id="cb58-12"><a href="modelos-sintéticos-simples.html#cb58-12" tabindex="-1"></a>model_Multinom <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/model_Multinom.rds&quot;</span>)</span></code></pre></div>
<p>La estimación del parámetro <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\delta\)</span> es:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="modelos-sintéticos-simples.html#cb59-1" tabindex="-1"></a>tabla_Mul1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_Multinom, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;delta&quot;</span>, <span class="st">&quot;theta&quot;</span>))<span class="sc">$</span>summary </span>
<span id="cb59-2"><a href="modelos-sintéticos-simples.html#cb59-2" tabindex="-1"></a>tabla_Mul1 <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code></pre></div>
<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
25%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
75%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
delta
</td>
<td style="text-align:right;">
0.0446
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e-04
</td>
<td style="text-align:right;">
0.0436
</td>
<td style="text-align:right;">
0.0442
</td>
<td style="text-align:right;">
0.0446
</td>
<td style="text-align:right;">
0.0449
</td>
<td style="text-align:right;">
0.0456
</td>
<td style="text-align:right;">
830.6843
</td>
<td style="text-align:right;">
1.0017
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[1]
</td>
<td style="text-align:right;">
0.5876
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9e-04
</td>
<td style="text-align:right;">
0.5858
</td>
<td style="text-align:right;">
0.5870
</td>
<td style="text-align:right;">
0.5876
</td>
<td style="text-align:right;">
0.5882
</td>
<td style="text-align:right;">
0.5894
</td>
<td style="text-align:right;">
1905.1503
</td>
<td style="text-align:right;">
0.9986
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[2]
</td>
<td style="text-align:right;">
0.0274
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3e-04
</td>
<td style="text-align:right;">
0.0268
</td>
<td style="text-align:right;">
0.0272
</td>
<td style="text-align:right;">
0.0274
</td>
<td style="text-align:right;">
0.0276
</td>
<td style="text-align:right;">
0.0281
</td>
<td style="text-align:right;">
811.4177
</td>
<td style="text-align:right;">
1.0018
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[3]
</td>
<td style="text-align:right;">
0.3850
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9e-04
</td>
<td style="text-align:right;">
0.3832
</td>
<td style="text-align:right;">
0.3843
</td>
<td style="text-align:right;">
0.3850
</td>
<td style="text-align:right;">
0.3856
</td>
<td style="text-align:right;">
0.3868
</td>
<td style="text-align:right;">
1564.5875
</td>
<td style="text-align:right;">
0.9987
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="modelos-sintéticos-simples.html#cb60-1" tabindex="-1"></a>posterior_theta1 <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Multinom, <span class="at">pars =</span> <span class="st">&quot;theta[1]&quot;</span>)</span>
<span id="cb60-2"><a href="modelos-sintéticos-simples.html#cb60-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_theta1) <span class="sc">+</span></span>
<span id="cb60-3"><a href="modelos-sintéticos-simples.html#cb60-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_theta1) ) <span class="sc">/</span></span>
<span id="cb60-4"><a href="modelos-sintéticos-simples.html#cb60-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_theta1)</span>
<span id="cb60-5"><a href="modelos-sintéticos-simples.html#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="modelos-sintéticos-simples.html#cb60-6" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb60-7"><a href="modelos-sintéticos-simples.html#cb60-7" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/Multinomial1.png&quot;,</span></span>
<span id="cb60-8"><a href="modelos-sintéticos-simples.html#cb60-8" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb60-9"><a href="modelos-sintéticos-simples.html#cb60-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Multinomial/Multinomial1.png" width="200%" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="modelos-sintéticos-simples.html#cb61-1" tabindex="-1"></a>posterior_theta2 <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Multinom, <span class="at">pars =</span> <span class="st">&quot;theta[2]&quot;</span>)</span>
<span id="cb61-2"><a href="modelos-sintéticos-simples.html#cb61-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_theta2) <span class="sc">+</span></span>
<span id="cb61-3"><a href="modelos-sintéticos-simples.html#cb61-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_theta2) ) <span class="sc">/</span></span>
<span id="cb61-4"><a href="modelos-sintéticos-simples.html#cb61-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_theta2)</span>
<span id="cb61-5"><a href="modelos-sintéticos-simples.html#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="modelos-sintéticos-simples.html#cb61-6" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb61-7"><a href="modelos-sintéticos-simples.html#cb61-7" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/Multinomial2.png&quot;,</span></span>
<span id="cb61-8"><a href="modelos-sintéticos-simples.html#cb61-8" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb61-9"><a href="modelos-sintéticos-simples.html#cb61-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Multinomial/Multinomial2.png" width="200%" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="modelos-sintéticos-simples.html#cb62-1" tabindex="-1"></a>posterior_theta3 <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Multinom, <span class="at">pars =</span> <span class="st">&quot;theta[3]&quot;</span>)</span>
<span id="cb62-2"><a href="modelos-sintéticos-simples.html#cb62-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_theta3) <span class="sc">+</span></span>
<span id="cb62-3"><a href="modelos-sintéticos-simples.html#cb62-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_theta3) ) <span class="sc">/</span></span>
<span id="cb62-4"><a href="modelos-sintéticos-simples.html#cb62-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_theta3)</span>
<span id="cb62-5"><a href="modelos-sintéticos-simples.html#cb62-5" tabindex="-1"></a></span>
<span id="cb62-6"><a href="modelos-sintéticos-simples.html#cb62-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> p1,</span>
<span id="cb62-7"><a href="modelos-sintéticos-simples.html#cb62-7" tabindex="-1"></a>       <span class="at">filename =</span> <span class="st">&quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/Multinomial3.png&quot;</span>,</span>
<span id="cb62-8"><a href="modelos-sintéticos-simples.html#cb62-8" tabindex="-1"></a>       <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb62-9"><a href="modelos-sintéticos-simples.html#cb62-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Multinomial/Multinomial3.png" width="200%" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="modelos-sintéticos-simples.html#cb63-1" tabindex="-1"></a>posterior_delta <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Multinom, <span class="at">pars =</span> <span class="st">&quot;delta&quot;</span>)</span>
<span id="cb63-2"><a href="modelos-sintéticos-simples.html#cb63-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (<span class="fu">mcmc_dens_chains</span>(posterior_delta) <span class="sc">+</span></span>
<span id="cb63-3"><a href="modelos-sintéticos-simples.html#cb63-3" tabindex="-1"></a>    <span class="fu">mcmc_areas</span>(posterior_delta) ) <span class="sc">/</span> </span>
<span id="cb63-4"><a href="modelos-sintéticos-simples.html#cb63-4" tabindex="-1"></a>  <span class="fu">mcmc_trace</span>(posterior_delta)</span>
<span id="cb63-5"><a href="modelos-sintéticos-simples.html#cb63-5" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb63-6"><a href="modelos-sintéticos-simples.html#cb63-6" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/Multinomial4.png&quot;,</span></span>
<span id="cb63-7"><a href="modelos-sintéticos-simples.html#cb63-7" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb63-8"><a href="modelos-sintéticos-simples.html#cb63-8" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Multinomial/Multinomial4.png" width="200%" /></p>
<p>La imagen es muy pesada no se carga al repositorio.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="modelos-sintéticos-simples.html#cb64-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dataMult)</span>
<span id="cb64-2"><a href="modelos-sintéticos-simples.html#cb64-2" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> <span class="fu">as.array</span>(model_Multinom, <span class="at">pars =</span> <span class="st">&quot;ypred&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="modelos-sintéticos-simples.html#cb64-3" tabindex="-1"></a>  <span class="fu">as_draws_matrix</span>()</span>
<span id="cb64-4"><a href="modelos-sintéticos-simples.html#cb64-4" tabindex="-1"></a></span>
<span id="cb64-5"><a href="modelos-sintéticos-simples.html#cb64-5" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">200</span>)</span>
<span id="cb64-6"><a href="modelos-sintéticos-simples.html#cb64-6" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[, <span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb64-7"><a href="modelos-sintéticos-simples.html#cb64-7" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(dataMult<span class="sc">$</span>n), y_pred2)</span>
<span id="cb64-8"><a href="modelos-sintéticos-simples.html#cb64-8" tabindex="-1"></a><span class="co"># ggsave(plot = p1,</span></span>
<span id="cb64-9"><a href="modelos-sintéticos-simples.html#cb64-9" tabindex="-1"></a><span class="co">#        filename = &quot;Recursos/Día1/Sesion3/0Recursos/Multinomial/ppc_multinomial.PNG&quot;,</span></span>
<span id="cb64-10"><a href="modelos-sintéticos-simples.html#cb64-10" tabindex="-1"></a><span class="co">#        scale = 2)</span></span>
<span id="cb64-11"><a href="modelos-sintéticos-simples.html#cb64-11" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Recursos/D%C3%ADa1/Sesion3/0Recursos/Multinomial/ppc_multinomial.PNG" width="200%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="día-1---sesión-3--fundamentos-de-la-inferencia-bayesiana-en-r-y-stan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="día-1---sesión-4--función-generalizada-de-varianza.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2023MEXsae/02-D1S3_Fundamentos_Bayesiana.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.pdf", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.epub", "Fortalecimiento de capacidades en Técnicas de Estimación en Áreas Pequeñas con enfoque Bayesiano para la desagregación de datos.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
